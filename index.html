<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<!-- PWA -->
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0d1117">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Stock Scan">
<link rel="apple-touch-icon" href="icons/icon-180.png">
<title>Stock Scan</title>

  <style>
    html{ background:#0d1117; }
    body{ margin:0; }

    body {
      background: #0d1117;
      color: #e5e7eb;
      font-family: "Segoe UI", Arial, Helvetica, sans-serif;
      padding: 16px 25px;
    }

/* =======================
   Lock screen UX (mobile)
   - é€²ç«™å…ˆé¡¯ç¤ºå¯†ç¢¼è¦–çª—ï¼Œä¸å…ˆéœ²å‡ºç©ºé é¢
   ======================= */
body.locked{
  overflow: hidden; /* é˜²æ­¢èƒŒæ™¯å¯æ»‘å‹• */
}
body.locked #appRoot{
  visibility: hidden;
}

/* iOS / Mobile: prevent unexpected zoom & text autosize */
html, body{
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}


    /* =======================
       Sticky Logo Header
       - åªå›ºå®šæœ€ä¸Šå±¤ Logo å€å¡Šï¼ˆheaderï¼‰
       ======================= */
    :root{ --header-h: 0px; }

    body{
      /* header å›ºå®šå¾Œï¼Œé¿å…å…§å®¹è¢«è“‹ä½ï¼ˆç”± JS è¨ˆç®— header é«˜åº¦ï¼‰ */
      padding-top: calc(16px + var(--header-h, 0px));
    }
    .header{
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 800;
      background: #0d1117;
      padding: calc(10px + env(safe-area-inset-top, 0px)) 25px 8px;
      margin-bottom: 0;
      box-shadow: 0 8px 18px rgba(0,0,0,.28);
    }

    /* Headerï¼šç½®ä¸­ Logo */
    .header{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:6px;
      margin-bottom:10px;
    }
    .header-logo{
      width:96px;
      max-width:70vw;
      height:auto;
      display:block;
      filter: drop-shadow(0 0 18px rgba(176,0,0,.28));
    }
    .subtitle{
      font-size:12px;
      line-height:1.2;
      color:#9ca3af;
      text-align:center;
      margin:0;
      margin-top:-2px;
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      margin-bottom: 18px;
    }
    #marketSelect,#filterMode,#sortKey{
      padding:7px 10px;
      border-radius:6px;
      border:1px solid #4b5563;
      background:#111827;
      color:#e5e7eb;
      outline:none;
    }
    #searchBox{
      padding:8px 12px;
      min-width:220px;
      border:1px solid #3b82f6;
      border-radius:6px;
      background:#111827;
      color:#e5e7eb;
      font-size:14px;
      outline:none;
      transition:.25s;
    }
    #searchBox::placeholder{ color:#6b7280; }
    #searchBox:focus{ box-shadow:0 0 8px #3b82f6; }
    #sortDirBtn{
      padding:7px 12px;
      border-radius:999px;
      border:1px solid #4b5563;
      background:#111827;
      color:#e5e7eb;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:4px;
    }
    #sortDirBtn:hover{ background:#1f2937; }

    /* ===== Sort direction icon (æ–¹æ¡ˆ C + å‹•ç•«) ===== */
.sort-anim{
  display:inline-block;
  --rot: 0deg;
  --lift: 0px;
  transform: translateY(var(--lift)) rotate(var(--rot));
  transition: transform .28s cubic-bezier(.34,1.56,.64,1), text-shadow .18s ease, color .18s ease;
  will-change: transform;
  font-size: 16px; /* ç®­é ­åŠ å¤§ä¸€é» */
  line-height: 1;

}
.sort-up{
  --lift: -2px; /* å‡å†ªï¼šå¾®æµ®èµ· */
  color:#22c55e;
  font-weight:1000;
  text-shadow:0 0 8px rgba(34,197,94,.65);
}
.sort-down{
  --lift: 2px; /* é™å†ªï¼šå¾®ä¸‹æ²‰ */
  color:#ef4444;
  font-weight:1000;
  text-shadow:0 0 8px rgba(239,68,68,.65);
}

/* æ‰‹æ©Ÿç«¯ï¼šé¡¯ç¤ºæ¨¡å¼åˆ‡æ›ï¼ˆå¡ç‰‡ / è¡¨æ ¼ï¼‰- Segmented */
    .segmented{
      display:none; /* æ¡Œæ©Ÿ/å¹³æ¿é è¨­ä¸é¡¯ç¤º */
      border:1px solid #4b5563;
      background:#0b1220;
      border-radius:999px;
      overflow:hidden;
      box-shadow:0 0 14px rgba(0,0,0,.25);
    }
    .seg-btn{
      appearance:none;
      border:0;
      padding:7px 14px;
      background:transparent;
      color:#e5e7eb;
      cursor:pointer;
      font-weight:1000;
      letter-spacing:.2px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width:74px;
      transition: .18s ease;
    }
    .seg-btn:hover{
      background: rgba(31,41,55,.65);
    }
    .seg-btn.active{
      background: linear-gradient(90deg, rgba(59,130,246,.35), rgba(59,130,246,.75), rgba(59,130,246,.35));
      color:#0b1220;
      text-shadow: none;
    }

    .summary{ font-size:12px; color:#9ca3af; }

    /* å³ä¸Šè§’ï¼šåŠ æ¬ŠæŒ‡æ•¸å€å¡Š */
    .taiex-box{
      margin-left:auto;
      padding:8px 12px;
      border:1px solid rgba(148,163,184,.35);
      background: linear-gradient(90deg, rgba(17,24,39,.55), rgba(59,130,246,.18), rgba(17,24,39,.55));
      background-size: 220% 220%;
      animation: mpiSweep 2.0s ease-in-out infinite;
      border-radius:10px;
      min-width:320px;
      display:flex;
      align-items:center;
      justify-content:flex-start;
      gap:10px;
      box-shadow: 0 0 18px rgba(0,0,0,.35);
    }
    .taiex-name{ color:#93c5fd; font-size:12px; font-weight:800; letter-spacing:.3px; }
    .taiex-close{ color:#e5e7eb; font-size:15px; font-weight:950; }
    .taiex-chg{ font-size:13px; font-weight:900; padding:2px 8px; border-radius:999px; }
    .taiex-up{ color:#ef4444; background:rgba(239,68,68,.12); text-shadow:0 0 8px rgba(239,68,68,.35); }
    .taiex-down{ color:#22c55e; background:rgba(34,197,94,.12); text-shadow:0 0 8px rgba(34,197,94,.28); }
    .taiex-flat{ color:#9ca3af; background:rgba(156,163,175,.10); }
    .taiex-meta{ color:#9ca3af; font-size:11px; }


    table{
      width:100%;
      border-collapse:collapse;
      background:#111827;
      border-radius:10px;
      overflow:hidden;
      box-shadow:0 0 18px rgba(0,0,0,.45);
    }

    /* =======================
       FIX: ç©©å®šã€Œè‚¡ç¥¨ä»£è™Ÿ / åç¨±ã€æ¬„å¯¬ï¼ˆåƒ…æ¡Œæ©Ÿ/å¯¬è¢å¹•ï¼‰
       - é¿å…ä¸åŒç¯©é¸æ¨¡å¼å› è³‡æ–™é›†åˆä¸åŒè€Œè‡ªå‹•é‡ç®—å‰å…©æ¬„å¯¬åº¦
       - æ‰‹æ©Ÿ/å¹³æ¿ä»ç¶­æŒ table-layout:autoï¼Œé¿å… icon/å…§å®¹è¢«æ“ å‡ºæ ¼å­
       ======================= */
    @media (min-width: 981px){
      table{ table-layout: fixed; }
      th:nth-child(1), td:nth-child(1){ width: 110px; } /* è‚¡ç¥¨ä»£è™Ÿ */
      th:nth-child(2), td:nth-child(2){ width: 160px; } /* åç¨± */
      th:nth-child(3), td:nth-child(3){ width: 170px; } /* è‚¡åƒ¹ï¼ˆå«æ¼²åœ icon åºåˆ—ï¼‰ */
    }
    @media (max-width: 980px){
      table{ table-layout: auto; }
      th:nth-child(1), td:nth-child(1),
      th:nth-child(2), td:nth-child(2),
      th:nth-child(3), td:nth-child(3){ width: auto; }
    }

    /* æ¼²åœ iconï¼šæ°¸é ä¸æ›è¡Œã€ä¸è¦æŠŠ icon æ“ å‡ºæ ¼å­ */
    .limit-icons{ flex-wrap: nowrap; white-space: nowrap; }

    th{
      background:#1f2937;
      padding:9px;
      font-size:13px;
      color:#93c5fd;
      text-align:center;
      border-bottom:1px solid #374151;
      white-space:nowrap;
    }
    td{
      padding:9px;
      text-align:center;
      border-bottom:1px solid #1f2937;
      color:#d1d5db;
      font-size:13px;
      white-space:nowrap;
    }
    tr:hover{ background:rgba(59,130,246,.15); }

    


    .disclaimer{
      margin-top: 18px;
      color:#9ca3af;
      font-size:12px;
      line-height:1.6;
      padding: 12px 12px;
      border: 1px solid rgba(148,163,184,.16);
      background: rgba(17,24,39,.55);
      border-radius: 12px;
    }

.tag{
      background:#3b82f6;
      padding:3px 8px;
      color:white;
      border-radius:6px;
      font-weight:bold;
      box-shadow:0 0 10px rgba(59,130,246,.65);
    }

    /* ===== MPI badgeï¼ˆç§‘æŠ€æ„Ÿï¼‰ ===== */
    .mpi-badge{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width:34px;
      padding:3px 10px;
      border-radius:999px;
      font-weight:1000;
      letter-spacing:.6px;
      border:1px solid rgba(148,163,184,.35);
      background: linear-gradient(90deg, rgba(17,24,39,.55), rgba(59,130,246,.18), rgba(17,24,39,.55));
      background-size: 220% 220%;
      animation: mpiSweep 2.0s ease-in-out infinite;
      box-shadow: 0 0 14px rgba(0,0,0,.35);
    }
    .mpi-S{ color:#ffd0d6; text-shadow:0 0 10px rgba(255,30,120,.55); border-color: rgba(255,30,120,.35); }
    .mpi-A{ color:#ffe9c7; text-shadow:0 0 10px rgba(249,115,22,.45); border-color: rgba(249,115,22,.30); }
    .mpi-B{ color:#d8ffe7; text-shadow:0 0 10px rgba(16,255,160,.45); border-color: rgba(16,255,160,.25); }
    .mpi-C{ color:#dbeafe; text-shadow:0 0 10px rgba(59,130,246,.45); border-color: rgba(59,130,246,.25); }
    .mpi-none{ color:#6b7280; }
/* æ©˜è‰²ï¼ˆåƒ¹æ ¼/é‡çš„é è¨­è‰²ï¼‰ */
    .value-orange{
      color:#f97316;
      font-weight:900;
      text-shadow:0 0 6px rgba(249,115,22,.55);
    }

    /* æ¼²åœï¼šç´… / è¢å…‰ç´…ï¼ˆè¦†è“‹ value-orangeï¼‰ */
        /* æ¼²åœï¼šç´… / è¢å…‰ç´…ï¼ˆè¦†è“‹ value-orangeï¼‰
       - æ–‡å­—æ¨£å¼ç•™åœ¨ class ä¸Š
       - åº•è‰²æ”¹ç”±ã€Œtd::beforeã€ç¹ªè£½ï¼Œé¿å…å£“åˆ°è¡¨æ ¼åˆ†éš”ç·šï¼ˆè·Ÿæ¼²è·Œå¹…åº•è‰²è¦–è¦ºä¸€è‡´ï¼‰
    */
    .value-red,
    .value-neonred{
      color:#ff0000; /* éå¸¸é®®ç´… */
      font-weight:1000;
      letter-spacing:.45px;

      /* class æœ¬èº«ä¸ç•«åº•è‰²ã€ä¸åŠ  paddingï¼Œé¿å…æ’å¤§/å£“ç·š */
      background:none;
      padding:0;
      box-shadow:none;

      text-shadow:
        0 0 2px rgba(255,0,0,.9),
        0 0 6px rgba(255,0,0,.45);
    }

    /* åƒ¹æ ¼æ¬„ä½ tdï¼šç”¨ ::before ç•«åº•è‰²ï¼ˆä¸ç¢°ä¸Šä¸‹/å·¦å³åˆ†éš”ç·šï¼‰ */
    td.value-red,
    td.value-neonred{
      position: relative;
    }
    td.value-red::before,
    td.value-neonred::before{
      content:"";
      position:absolute;
      inset: 6px;              /* é—œéµï¼šç¸®é€²ï¼Œé¿å…å£“åˆ°ä¸Š/ä¸‹æ©«ç·š */
      border-radius:10px;      /* è·Ÿæ¼²è·Œå¹…ä¸€è‡´ */
      background: linear-gradient(180deg, rgba(255,0,0,.22), rgba(255,0,0,.08));
      pointer-events:none;

      /* âœ… æ”¾åˆ°æ–‡å­—å¾Œé¢ï¼Œé¿å…ä»»ä½•ç€è¦½å™¨æŠŠæ–‡å­—ã€Œè“‹ä½ã€é€ æˆæ¨¡ç³Š */
      z-index: -1;
    }

    /* âœ… è®“ td è‡ªå·±å½¢æˆ stacking contextï¼Œç¢ºä¿ ::before åœ¨åº•å±¤ã€æ–‡å­—åœ¨ä¸Šå±¤ */
    td.value-red,
    td.value-neonred{
      position: relative;
      isolation: isolate;
    }

    /* è·Œåœï¼šç¶ ï¼ˆæ¨£å¼/å°ºå¯¸/é€æ˜åº¦ èˆ‡ æ¼²åœä¸€è‡´ï¼‰ */
    .value-green,
    .value-neongreen{
      color:#22c55e; /* é®®ç¶  */
      font-weight:1000;
      letter-spacing:.45px;
      background:none;
      padding:0;
      box-shadow:none;
      text-shadow:
        0 0 2px rgba(34,197,94,.9),
        0 0 6px rgba(34,197,94,.45);
    }

    td.value-green,
    td.value-neongreen{
      position: relative;
      isolation: isolate;
    }
    td.value-green::before,
    td.value-neongreen::before{
      content:"";
      position:absolute;
      inset: 6px;
      border-radius:10px;
      background: linear-gradient(180deg, rgba(34,197,94,.22), rgba(34,197,94,.08));
      pointer-events:none;
      z-index:-1;
    }

@keyframes mpiSweep{
      0%{background-position:0% 50%; filter:brightness(1)}
      50%{background-position:100% 50%; filter:brightness(1.15)}
      100%{background-position:0% 50%; filter:brightness(1)}
    }

    @keyframes neonSweep{
      0%{background-position:0% 50%}
      50%{background-position:100% 50%}
      100%{background-position:0% 50%}
    }

    @keyframes neonFlicker{
      0%,100%{opacity:1; transform: translateY(-1px) scale(1)}
      45%{opacity:.82; transform: translateY(-1px) scale(1.02)}
      50%{opacity:.68; transform: translateY(-1px) scale(.98)}
      55%{opacity:.92; transform: translateY(-1px) scale(1.03)}
    }
    

    /* æ¼²åœ iconï¼ˆè·Ÿè‘—ç´…/è¢å…‰ç´…ï¼‰ */
    .limit-icons{
      display:inline-flex;
      align-items:center;
      gap:3px;
      margin-left:6px;
      transform: translateY(-1px);
      user-select:none;
    }
    .limit-iconss{
      display:inline-block;
      font-size:14px;
      line-height:1;
      letter-spacing:1px;
      filter: drop-shadow(0 0 10px rgba(255,255,255,.10));
    }
    .limit-iconss--lightning{
      padding:2px 8px;
      border-radius:999px;
      backdrop-filter: blur(6px);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.08);
      background:
        radial-gradient(120px 40px at 20% 10%, rgba(176,0,0,.45), rgba(0,0,0,0)),
        linear-gradient(90deg, rgba(176,0,0,.22), rgba(122,0,0,.70), rgba(176,0,0,.22));
      filter: drop-shadow(0 0 16px rgba(176,0,0,.55));
      animation: neonFlicker 1.2s ease-in-out infinite;
    }
    /* ğŸ”¥ï¼šä¸éœ€è¦åº•è‰²ï¼Œåªè¦æ›´ç´…æ›´å…‡çš„ glow */
    .limit-iconss--fire{
      padding:0;
      border-radius:0;
      background: transparent;
      box-shadow:none;
      filter: drop-shadow(0 0 14px rgba(255,0,0,.55));
      animation: fireFlicker 1.1s ease-in-out infinite;
    }
    @keyframes fireFlicker{
      0%   { filter:brightness(1) saturate(1.05); }
      50%  { filter:brightness(1.22) saturate(1.30); }
      100% { filter:brightness(1) saturate(1.05); }
    }
    /* ===== Hot rows (|chg|>=7): å·¦å´éœ“è™¹é‚Šæ¢ï¼ˆæ”¹ç”¨ç¬¬ä¸€æ¬„ td çš„ ::beforeï¼ŒiOS/Safari ä¹Ÿç©©å®šé¡¯ç¤ºï¼‰ ===== */
    tbody td:first-child{ position: relative; }
    tbody tr td:first-child{ padding-left: 14px; } /* é ç•™é‚Šæ¢ç©ºé–“ï¼Œé¿å…è¦–è¦ºè·³å‹• */
    tbody tr td:first-child::before{
      content:"";
      position:absolute;
      left:0;
      top:0;
      bottom:0;
      width:5px;
      background: transparent;
      border-radius: 0; /* è®“é‚Šæ¢ç›´åˆ°åº• */
    }
    tbody tr.hot-up td:first-child::before{
      background: transparent;
      box-shadow: none;
      animation: none;
    }
    tbody tr.hot-down td:first-child::before{
      background: transparent;
      box-shadow: none;
      animation: none;
    }
/* æ¼²è·Œå¹…ï¼šæ­£ç´…ã€è² ç¶ ï¼›|>=7| éœ“è™¹ */
    .chg-up{
      color:#ef4444; font-weight:950;
      text-shadow:0 0 8px rgba(239,68,68,.55);
      border-radius:10px;
      background: radial-gradient(120% 90% at 50% 50%, rgba(239,68,68,0.16), rgba(0,0,0,0) 70%);
    }
    .chg-down{
      color:#22c55e; font-weight:950;
      text-shadow:0 0 8px rgba(34,197,94,.55);
      border-radius:10px;
      background: radial-gradient(120% 90% at 50% 50%, rgba(34,197,94,0.14), rgba(0,0,0,0) 70%);
    }
    .chg-hot-up{
      color:#ffd0d6; font-weight:1000; letter-spacing:.4px;
      background:linear-gradient(90deg, rgba(239,68,68,.25), rgba(255,30,120,.62), rgba(239,68,68,.25));
      background-size:220% 220%;
      animation:neonSweep 1.6s ease-in-out infinite;
      border-radius:12px;
      text-shadow:0 0 14px rgba(176,0,0,1);
      box-shadow: inset 0 0 0 1px rgba(255,120,140,0.18), 0 0 18px rgba(176,0,0,0.12);
    }
    .chg-hot-down{
      color:#d8ffe7; font-weight:1000; letter-spacing:.4px;
      background:linear-gradient(90deg, rgba(34,197,94,.20), rgba(16,255,160,.55), rgba(34,197,94,.20));
      background-size:220% 220%;
      animation:neonSweep 1.6s ease-in-out infinite;
      border-radius:12px;
      text-shadow:0 0 14px rgba(34,197,94,1);
      box-shadow: inset 0 0 0 1px rgba(120,255,190,0.16), 0 0 18px rgba(34,197,94,0.10);
    }

    /* =======================
       TUNE: å–æ¶ˆã€Œæ¼²å¹…>=7%ã€çš„ç²‰ç´…/éœ“è™¹æ•ˆæœï¼ˆä¿ç•™ä¸€èˆ¬ç´…/ç¶ æ–‡å­—ï¼‰
       ======================= */
    .chg-hot-up{
      color:#ef4444 !important;
      font-weight:950 !important;
      letter-spacing:0 !important;
      background: radial-gradient(120% 90% at 50% 50%, rgba(239,68,68,0.16), rgba(0,0,0,0) 70%) !important;
      animation:none !important;
      border-radius:10px !important;
      text-shadow:0 0 8px rgba(239,68,68,.55) !important;
      box-shadow:none !important;
    }
    .chg-hot-down{
      color:#22c55e !important;
      font-weight:950 !important;
      letter-spacing:0 !important;
      background: radial-gradient(120% 90% at 50% 50%, rgba(34,197,94,0.14), rgba(0,0,0,0) 70%) !important;
      animation:none !important;
      border-radius:10px !important;
      text-shadow:0 0 8px rgba(34,197,94,.55) !important;
      box-shadow:none !important;
    }


    /* æŒ¯å¹…ï¼šæ­£ä¸”å‘ä¸Šç´… / æ­£ä¸”å‘ä¸‹ç¶  */
    .amp-up{
      color:#ef4444; font-weight:900;
      text-shadow:0 0 6px rgba(239,68,68,.4);
      border-radius:10px;
      background: radial-gradient(130% 95% at 50% 50%, rgba(239,68,68,0.12), rgba(0,0,0,0) 72%);
    }
    .amp-down{
      color:#22c55e; font-weight:900;
      text-shadow:0 0 6px rgba(34,197,94,.4);
      border-radius:10px;
      background: radial-gradient(130% 95% at 50% 50%, rgba(34,197,94,0.10), rgba(0,0,0,0) 72%);
    }

    .amp-zero{
      color:#8a8a8a;
      font-weight:800;
      letter-spacing:.2px;
    }

    .spark-cell{ padding:0; }

    a.stockLink{ color:#60a5fa; font-weight:bold; text-decoration:none; transition:.2s; }
    a.stockLink:hover{ color:#93c5fd; text-shadow:0 0 8px rgba(147,197,253,.8); }

    /* âœ… è‚¡åƒ¹ï¼ˆæ”¶ç›¤ï¼‰ç´…/ç¶ /ç°ï¼šåªæ”¹å­—è‰²ï¼Œä¸æ”¹åº•è‰²ï¼›å­—é‡èˆ‡ value-orange ä¸€è‡´ï¼ˆä¸å†è®Šç´°ï¼‰ */
    .price-up{
      color:#ff3b30 !important;
      font-weight:900;
      text-shadow:0 0 6px rgba(255,59,48,.55);
    }
    .price-down{
      color:#34c759 !important;
      font-weight:900;
      text-shadow:0 0 6px rgba(52,199,89,.45);
    }
    .price-flat{
      color:#9ca3af !important;
      font-weight:900;
      text-shadow:0 0 4px rgba(156,163,175,.35);
    }

    /* =======================
       Responsive (Mobile/Pad)
       ======================= */

    /* è®“è¡¨æ ¼åœ¨å°è¢å¹•å¯ä»¥å·¦å³æ»‘ï¼Œä¸çˆ†ç‰ˆ */
    .table-wrap{
      width:100%;
      overflow-x:auto;
      -webkit-overflow-scrolling: touch;
      border-radius:10px;
    }
    .table-wrap table{
      min-width: 980px; /* æ¡Œæ©Ÿæ­£å¸¸é¡¯ç¤ºï¼›æ‰‹æ©Ÿç”¨æ»‘å‹• */
    }

    /* Padï¼šç¸®å° paddingã€åŠ æ¬ŠæŒ‡æ•¸ä¸è¦ç¡¬å¡åœ¨å³é‚Š */
    @media (max-width: 980px){
      body{ padding-left: 12px; padding-right: 12px; }


      .taiex-box{
        margin-left: 0;
        min-width: 0;
        width: 100%;
        justify-content: space-between;
      }
    }

    /* Phoneï¼štoolbar ç›´æ’ï¼Œæ§åˆ¶é …å…¨å¯¬ï¼Œè¡¨æ ¼éš±è—éƒ¨åˆ†æ¬„ä½ */
    @media (max-width: 720px){
      /* æ‰‹æ©Ÿï¼šå¤šç•™ 6px ç·©è¡ï¼Œé¿å…é«˜åº¦å››æ¨äº”å…¥é€ æˆ toolbar è¢«å£“åˆ° */
      /* body padding-top ç”±å…¨åŸŸï¼ˆheader é«˜åº¦ï¼‰æ§åˆ¶ï¼Œé¿å… iOS safe-area é‡ç®—é€ æˆç©¿é€ */
      body{ padding-top: calc(16px + var(--header-h, 0px)); }
      .toolbar{ gap:10px; }

      /* toolbar å…§æ¯å€‹å€å¡Šéƒ½åƒæ»¿ */
      .toolbar > div{ width: 100%; }

      #marketSelect,#filterMode,#sortKey,#searchBox{
        width:100%;
        min-width: 0;
        box-sizing:border-box;
      }

      #sortDirBtn{
        width:100%;
        justify-content:center;
      }
      

      /* æ‰‹æ©Ÿï¼šæ’åºç®­é ­å†å¤§ä¸€é» */
      .sort-anim{ font-size: 18px; }
/* æ‰‹æ©Ÿï¼šè¡¨æ ¼ä¿ç•™æ‰€æœ‰æ¬„ä½ï¼ˆå¯å·¦å³æ»‘ï¼‰ */
      .table-wrap table{ min-width: 980px; }

      th, td{
        padding: 8px 6px;
        font-size: 12px;
      }

      .header-logo{ width: 84px; }
    }

  
    /* =======================
       Card view (Phone)
       ======================= */
    .cards{
      display:none; /* æ¡Œæ©Ÿé è¨­éš±è— */
      width:100%;
    }
    .card{
      background:#111827;
      border:1px solid rgba(148,163,184,.18);
      border-radius:14px;
      padding:12px 12px;
      box-shadow:0 0 18px rgba(0,0,0,.35);
    }

    /* Cardï¼šæ¼²åœ/è·Œåœæ·¡è‰²åº•ï¼ˆé€é€çš„ï¼Œä¸æ¶å­—ï¼‰ */
    .card.card-limitup{
      background: linear-gradient(180deg, rgba(255,0,0,.12), rgba(17,24,39,0) 72%), #111827;
      border-color: rgba(255,0,0,.18);
      box-shadow: 0 0 18px rgba(0,0,0,.35), 0 0 14px rgba(255,0,0,.10);
    }
    .card.card-limitdown{
      background: linear-gradient(180deg, rgba(34,197,94,.12), rgba(17,24,39,0) 72%), #111827;
      border-color: rgba(34,197,94,.18);
      box-shadow: 0 0 18px rgba(0,0,0,.35), 0 0 14px rgba(34,197,94,.10);
    }
    .card-top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .card-title{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width:0;
    }
    .card-name{
      font-weight:950;
      color:#e5e7eb;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 70vw;
    }
    .card-sub{
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
      color:#9ca3af;
      font-size:12px;
    }
    .card-price{
      display:flex;
      align-items:center;
      gap:8px;
      justify-content:flex-end;
      flex-wrap:wrap;
      text-align:right;
      margin-left:auto;
    }
    .card-price .p{
      font-size:18px;
      font-weight:1000;
    }
    .card-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:8px 10px;
      margin-top:10px;
    }
    .kv{
      display:flex;
      justify-content:space-between;
      gap:10px;
      padding:6px 8px;
      border-radius:12px;
      background: rgba(31,41,55,.55);
      border: 1px solid rgba(148,163,184,.10);
    }
    .kv .k{
      color:#9ca3af;
      font-size:12px;
      white-space:nowrap;
    }
    .kv .v{
      color:#e5e7eb;
      font-size:12px;
      font-weight:900;
      white-space:nowrap;
    }
    .card-actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
      padding-top:10px;
      border-top:1px solid rgba(148,163,184,.12);
    }
    .card-actions a{
      font-size:12px;
      text-decoration:none;
      color:#60a5fa;
      font-weight:900;
    }
    .card-actions a:hover{
      color:#93c5fd;
      text-shadow:0 0 8px rgba(147,197,253,.8);
    }

    /* Phoneï¼šé è¨­å¡ç‰‡ï¼Œå¯åˆ‡æ›è¡¨æ ¼ï¼ˆå·¦å³æ»‘ï¼‰ */
    @media (max-width: 720px){
      /* é¡¯ç¤ºåˆ‡æ›éˆ• */
      .segmented{ display:flex; width:100%; }
      .seg-btn{ flex:1; min-width:0; }

      /* å…©ç¨®æ¨¡å¼ï¼ˆé è¨­ï¼šmobile-view-cardsï¼‰ */
      body.mobile-view-cards .table-wrap{ display:none; }
      body.mobile-view-cards .cards{ display:flex; flex-direction:column; gap:12px; }

      body.mobile-view-table .table-wrap{ display:block; }
      body.mobile-view-table .cards{ display:none; }
    }

    /* =======================
       FIX: Mobile header overlay
       - é¿å… @media(max-width:980) æ”¹ padding å¾Œï¼Œheader å›ºå®šé€ æˆé®åˆ° toolbar
       - æ‰‹æ©Ÿç«¯ header å·¦å³ padding è·Ÿ body ä¸€è‡´
       ======================= */
    @media (max-width: 720px){
      .header{ padding-left: 12px; padding-right: 12px; padding-top: calc(10px + env(safe-area-inset-top, 0px)); }
    }

    /* =======================
       FIX: Mobile limit-up pill overflow when too many icons
       - td::before ä½¿ç”¨ inset:6px æœƒåœ¨å·¦å³ç•™ä¸‹ç©ºç™½ï¼Œç•¶ icon>2 æ™‚çœ‹èµ·ä¾†åƒæ–‡å­—/æ•¸å­—è¶…å‡ºåº•è‰²
       - æ‰‹æ©Ÿç«¯æŠŠå·¦å³ inset æ”¾å¯¬ï¼Œä¿ç•™ä¸Šä¸‹ 6px é¿å…å£“åˆ°åˆ†éš”ç·š
       ======================= */
    @media (max-width: 720px){
      td.value-red::before,
      td.value-neonred::before{
        inset: 6px 2px; /* ä¸Šä¸‹ 6pxã€å·¦å³ 2pxï¼šåº•è‰²æ›´å¯¬ä½†ä¸å£“ç·š */
      }
      .limit-icons{
        margin-left:4px;
        gap:2px;
      }
      .limit-iconss{ font-size:13px; }
    }

  
/* ===== Mobile tweaks (clean): center ONLY selected values + move search below sort direction ===== */
@media (max-width: 720px){
  /* åªç½®ä¸­ã€Œé¸åˆ°çš„å€¼ã€ï¼ˆselect é¡¯ç¤ºæ–‡å­—ï¼‰ï¼›label ç¶­æŒåŸæ¨£ */
  #marketSelect,
  #filterMode,
  #sortKey{
    text-align: center;
    text-align-last: center; /* Android/Chrome */
  }

  /* æ‰‹æ©Ÿç«¯é‡æ–°æ’åˆ— toolbarï¼šè®“æœå°‹æ¡†åœ¨ã€Œæ’åºæ–¹å‘ã€ä¸‹é¢ */
  .toolbar{ display:flex; flex-wrap:wrap; }
  .toolbar > :nth-child(1){ order: 1; } /* å¸‚å ´ */
  .toolbar > :nth-child(2){ order: 2; } /* ç¯©é¸æ¨¡å¼ */
  .toolbar > :nth-child(4){ order: 3; } /* æ’åºæ¬„ä½ */
  .toolbar > :nth-child(5){ order: 4; } /* æ’åºæ–¹å‘ */
  .toolbar > :nth-child(3){ order: 5; } /* æœå°‹æ¡† */
  .toolbar > :nth-child(6){ order: 6; } /* ç›®å‰é¡¯ç¤º */
  .toolbar > :nth-child(7){ order: 7; } /* å¡ç‰‡/è¡¨æ ¼åˆ‡æ› */
  .toolbar > :nth-child(8){ order: 8; } /* åŠ æ¬ŠæŒ‡æ•¸ */
}

/* =======================
   Tech Password Modal
   ======================= */
.pw-backdrop{
  pointer-events: auto;
  cursor: default;

  position: fixed;
  inset: 0;
  z-index: 99999;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 18px;
  background:
    radial-gradient(1200px 600px at 50% 20%, rgba(59,130,246,.22), rgba(0,0,0,0) 60%),
    radial-gradient(900px 520px at 20% 85%, rgba(255,0,0,.10), rgba(0,0,0,0) 55%),
    rgba(0,0,0,.62);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}
.pw-backdrop.show{ display:flex; }

.pw-modal{
  width: min(360px, 90vw);
  border-radius: 18px;
  border: 1px solid rgba(148,163,184,.22);
  background:
    linear-gradient(180deg, rgba(17,24,39,.92), rgba(11,18,32,.88));
  box-shadow:
    0 20px 60px rgba(0,0,0,.55),
    0 0 26px rgba(59,130,246,.14),
    0 0 22px rgba(255,0,0,.08);
  overflow: hidden;
  position: relative;
}
/* subtle scanlines */
.pw-modal::before{
  content:"";
  position:absolute;
  inset:0;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(255,255,255,.035) 0px,
      rgba(255,255,255,.035) 1px,
      rgba(0,0,0,0) 3px,
      rgba(0,0,0,0) 6px
    );
  opacity:.26;
  pointer-events:none;
  mix-blend-mode: overlay;
}
/* animated glow edge */
.pw-modal::after{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius: 20px;
  background: linear-gradient(90deg,
    rgba(59,130,246,.0),
    rgba(59,130,246,.45),
    rgba(255,0,0,.22),
    rgba(59,130,246,.45),
    rgba(59,130,246,.0)
  );
  background-size: 240% 240%;
  animation: pwGlow 2.4s ease-in-out infinite;
  opacity:.35;
  pointer-events:none;
  filter: blur(10px);
}
@keyframes pwGlow{
  0%{ background-position: 0% 50%; }
  50%{ background-position: 100% 50%; }
  100%{ background-position: 0% 50%; }
}

.pw-head{
  display:flex;
  align-items:center;
  justify-content:center;
  position: relative;
  gap:10px;
  padding: 14px 16px 10px;
  position: relative;
  z-index: 1;
}
.pw-title{
  display:flex;justify-content:center;width:auto;
  align-items:center;
  gap:10px;
  font-weight: 1000;
  letter-spacing: .4px;
  color:#e5e7eb;
  font-size: 14px;
}
.pw-badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding: 2px 10px;
  border-radius: 999px;
  border:1px solid rgba(59,130,246,.35);
  background: rgba(59,130,246,.14);
  color:#93c5fd;
  font-size: 12px;
  font-weight: 900;
  text-shadow: 0 0 10px rgba(59,130,246,.35);
}
.pw-close{
  border:0;
  background: transparent;
  color:#9ca3af;
  font-size: 18px;
  cursor:pointer;
  padding: 6px 8px;
  border-radius: 10px;
  transition: .18s ease;
  position: relative;
  z-index: 1;

  position: absolute;
  right: 12px;
  top: 10px;

  display:none;
}


.pw-close:hover{
  background: rgba(31,41,55,.65);
  color:#e5e7eb;
  box-shadow: 0 0 12px rgba(59,130,246,.18);
}

.pw-body{
  padding: 4px 16px 14px;
  position: relative;
  z-index: 1;
}
.pw-desc{
  margin: 0 0 10px 0;
  color:#9ca3af;
  font-size: 12px;
  line-height: 1.55;
}

.pw-input{
  width:260px;
  max-width:calc(100% - 32px);
  margin: 0 auto;
  display:block;
  box-sizing:border-box;
  padding: 11px 12px;
  border-radius: 12px;
  border: 1px solid rgba(148,163,184,.22);
  background: rgba(17,24,39,.85);
  color:#e5e7eb;
  outline:none;
  font-size: 16px;
  transition: .18s ease;
  box-shadow: inset 0 0 0 1px rgba(0,0,0,.0);
}
.pw-input::placeholder{ color:#6b7280; }
.pw-input:focus{
  border-color: rgba(59,130,246,.55);
  box-shadow: 0 0 0 3px rgba(59,130,246,.18), 0 0 16px rgba(59,130,246,.18);
}

.pw-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-top: 10px;
}
.pw-remember{
  display:flex;
  align-items:center;
  gap:8px;
  color:#cbd5e1;
  font-size: 12px;
  user-select:none;
}
.pw-remember input{
  accent-color: #3b82f6;
  transform: translateY(1px);
}

.pw-error{
  margin-top: 8px;
  min-height: 16px;
  font-size: 12px;
  color: #f87171;
  text-shadow: 0 0 10px rgba(248,113,113,.15);
}

.pw-actions{display:flex;gap:10px;margin-top:12px;justify-content:center;}
.pw-btn{
  width:260px;
  max-width:calc(100% - 32px);
  margin: 0 auto;
  flex: 0 0 auto;
  border-radius: 12px;
  padding: 10px 12px;
  border: 1px solid rgba(148,163,184,.22);
  background: rgba(17,24,39,.72);
  color:#e5e7eb;
  cursor:pointer;
  font-weight: 1000;
  letter-spacing: .25px;
  transition: .18s ease;
}
.pw-btn:hover{
  background: rgba(31,41,55,.75);
  box-shadow: 0 0 16px rgba(0,0,0,.28);
}
.pw-btn.primary{
  border-color: rgba(59,130,246,.55);
  background: linear-gradient(90deg, rgba(59,130,246,.18), rgba(59,130,246,.40), rgba(59,130,246,.18));
  box-shadow: 0 0 18px rgba(59,130,246,.14);
  color:#0b1220;
  text-shadow:none;
}
.pw-btn.primary:hover{
  filter: brightness(1.06);
  box-shadow: 0 0 26px rgba(59,130,246,.20);
}

/* =======================
   Tech Loading Overlay
   ======================= */
.load-overlay{
  position: fixed;
  inset: 0;
  z-index: 99998; /* below pw modal (99999) */
  display: none;
  align-items: center;
  justify-content: center;
  background:
    radial-gradient(1200px 700px at 50% 15%, rgba(59,130,246,.18), rgba(0,0,0,0) 60%),
    rgba(0,0,0,.45);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  pointer-events: none;
}
.load-overlay.show{ display:flex; }

.load-card{
  width: min(360px, 92vw);
  border-radius: 18px;
  border: 1px solid rgba(148,163,184,.18);
  background: linear-gradient(180deg, rgba(17,24,39,.70), rgba(11,18,32,.65));
  box-shadow: 0 18px 55px rgba(0,0,0,.55), 0 0 26px rgba(59,130,246,.12);
  padding: 18px 18px 16px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap: 12px;
}
.load-spinner{
  width: 54px; height: 54px;
  border-radius: 999px;
  border: 3px solid rgba(59,130,246,.18);
  border-top-color: rgba(59,130,246,.85);
  border-right-color: rgba(255,0,0,.40);
  animation: spin 0.9s linear infinite;
  box-shadow: 0 0 18px rgba(59,130,246,.18);
}
@keyframes spin{ to { transform: rotate(360deg); } }

.load-text{
  font-size: 12px;
  color: #9ca3af;
  letter-spacing: .35px;
  text-align:center;
  line-height: 1.5;
}
.load-text strong{
  color:#93c5fd;
  font-weight: 1000;
  text-shadow: 0 0 10px rgba(147,197,253,.25);
}

</style>
</head>

<body class="locked">
  <div id="appRoot" class="app-root">
  <div class="header">
    <img class="header-logo" id="logoBtn" src="logo.png" alt="SCAN logo" />
    <div class="subtitle" id="summaryText">è®€å–ä¸­â€¦</div>
  </div>

  <div class="toolbar">
    <div>
      <label for="marketSelect" style="font-size:12px; color:#9ca3af;">å¸‚å ´ï¼š</label>
      <select id="marketSelect">
        <option value="twse">ä¸Šå¸‚ (TWSE)</option>
        <option value="otc">ä¸Šæ«ƒ (OTC)</option>
      </select>
    </div>

    <div>
      <label for="filterMode" style="font-size:12px; color:#9ca3af;">ç¯©é¸æ¨¡å¼ï¼š</label>
      <select id="filterMode">
        <option value="all">é¡¯ç¤ºå…¨éƒ¨</option>
        <option value="limitup">æ¼²åœ</option>
        <option value="limitdown">è·Œåœ</option>
        <option value="mpi">MPI æ¨™çš„</option>
      </select>
    </div>

    <input id="searchBox" placeholder="æœå°‹ä»£è™Ÿæˆ–åç¨±..." />

    <div>
      <label for="sortKey" style="font-size:12px; color:#9ca3af;">æ’åºæ¬„ä½ï¼š</label>
      <select id="sortKey">
        <option value="close">è‚¡åƒ¹</option>
        <option value="volume">æˆäº¤é‡</option>
        <option value="chg_pct">æ¼²è·Œå¹…%</option>
        <option value="amplitude_pct">æŒ¯å¹…%</option>
      </select>
    </div>

    <button id="sortDirBtn">æ’åºæ–¹å‘ï¼š<span id="sortDirLabel" class="sort-anim sort-down">â‡£</span></button>
    <div class="summary"><span id="countInfo"></span></div>
    <div class="segmented" id="viewSegment" role="tablist" aria-label="æ‰‹æ©Ÿé¡¯ç¤ºæ¨¡å¼åˆ‡æ›">
      <button id="viewCardsBtn" class="seg-btn" type="button" role="tab" aria-selected="true">å¡ç‰‡</button>
      <button id="viewTableBtn" class="seg-btn" type="button" role="tab" aria-selected="false">è¡¨æ ¼</button>
    </div>

  

    <div id="taiexBox" class="taiex-box" aria-label="åŠ æ¬ŠæŒ‡æ•¸">
      <span class="taiex-name">åŠ æ¬ŠæŒ‡æ•¸</span>
      <span class="taiex-close" id="taiexClose">â€”</span>
      <span class="taiex-chg taiex-flat" id="taiexChg">â€”</span>
      <span class="taiex-meta" id="taiexTime"></span>
    </div>

  </div>



  <div id="cardContainer" class="cards" aria-live="polite"></div>

  <div class="table-wrap">
    <table>
    <thead>
      <tr>
        <th>è‚¡ç¥¨ä»£è™Ÿ</th>
        <th>åç¨±</th>
        <th>è‚¡åƒ¹</th>
        <th>é–‹ç›¤</th>
        <th>æœ€é«˜</th>
        <th>æœ€ä½</th>
        <th>æ˜¨æ”¶</th>
        <th>æˆäº¤é‡</th>
        <th>MPI</th>
        <th>æ¼²è·Œå¹…%</th>
        <th>æŒ¯å¹…%</th>
        <th>å°èµ°å‹¢</th>
        <th>å¤§è‚¡æ±æŒè‚¡</th>
        <th>æ–°è</th>
      </tr>
    </thead>
    <tbody id="resultBody">
      <tr><td colspan="14">æ­£åœ¨è¼‰å…¥çµæœ...</td></tr>
    </tbody>
    </table>
  </div>

  <div class="disclaimer">è³‡è¨Šä¾†æºï¼šè‡ºç£è­‰åˆ¸äº¤æ˜“æ‰€ TWSEã€è²¡åœ˜æ³•äººä¸­è¯æ°‘åœ‹è­‰åˆ¸æ«ƒæª¯è²·è³£ä¸­å¿ƒ GTSMã€‚ä½¿ç”¨è€…é ˆéµå®ˆå°ç£è­‰åˆ¸äº¤æ˜“æ‰€ã€Œäº¤æ˜“è³‡è¨Šä½¿ç”¨ç®¡ç†è¾¦æ³•ã€ç­‰äº¤æ˜“è³‡è¨Šç®¡ç†ç›¸é—œè¦å®šï¼Œæ‰€æœ‰è³‡è¨Šä»¥å°ç£è­‰åˆ¸äº¤æ˜“æ‰€å…¬å‘Šè³‡æ–™ç‚ºä¸»ã€‚æœ¬ç¶²ç«™æä¾›ä¹‹è³‡æ–™åƒ…ä¾›åƒè€ƒï¼Œå°è³‡è¨Šæ­£ç¢ºã€å»¶é²æˆ–å‚³è¼¸ä¸­æ–·ä¸è² ä»»ä½•è²¬ä»»ï¼Œå¦‚ä½¿ç”¨è€…ä¾æœ¬è³‡æ–™äº¤æ˜“ç™¼ç”Ÿæå¤±éœ€è‡ªè¡Œè² è²¬</div>

  <script>
    let allRows = [];

    // --- ENC cache (avoid re-prompt on UI changes) ---
    const _encCache = { twse: null, otc: null }; // decrypted JSON per market
    const _pwStoreKey = "SCAN_PW_V1";
    const _pwDateKey  = "SCAN_PW_DATE_V1"; // (legacy, no longer used)

    // --- Session cache (speed up mobile refresh/back) ---
    // sessionStorage survives reload (same tab), but clears when tab is closed.
    const _ssPrefix = "SCN_SS_CACHE_V1_";
    const _ssTTLms = 15 * 60 * 1000; // 15 minutes
    function _ssKey(market){ return _ssPrefix + (market === "otc" ? "otc" : "twse"); }
    function _ssSave(market, json){
      try{
        const payload = { t: Date.now(), json };
        sessionStorage.setItem(_ssKey(market), JSON.stringify(payload));
      }catch(_){}
    }
    function _ssLoad(market){
      try{
        const raw = sessionStorage.getItem(_ssKey(market));
        if (!raw) return null;
        const payload = JSON.parse(raw);
        if (!payload || !payload.t || !payload.json) return null;
        if (Date.now() - payload.t > _ssTTLms) return null;
        return payload.json;
      }catch(_){ return null; }
    }
    function _ssClear(){
      try{
        sessionStorage.removeItem(_ssKey("twse"));
        sessionStorage.removeItem(_ssKey("otc"));
      }catch(_){}
    }


// ---------- Sticky header height ----------
    function applyHeaderHeight(){
      const header = document.querySelector(".header");
      if (!header) return;
      const hh = Math.ceil(header.getBoundingClientRect().height);
      document.documentElement.style.setProperty("--header-h", `${hh}px`);
    }
    window.addEventListener("resize", applyHeaderHeight);
    window.addEventListener("load", applyHeaderHeight);
    document.addEventListener("DOMContentLoaded", () => {
      applyHeaderHeight();
      // å…§å®¹/å­—é«”è¼‰å…¥æˆ–æ‘˜è¦æ–‡å­—æ›´æ–°æ™‚ï¼Œé«˜åº¦å¯èƒ½æ”¹è®Šï¼šç”¨ ResizeObserver ä¿éšª
      const header = document.querySelector(".header");
      if (header && window.ResizeObserver){
        const ro = new ResizeObserver(() => applyHeaderHeight());
        ro.observe(header);
      }
      const logo = document.getElementById("logoBtn");
      if (logo) logo.addEventListener("load", applyHeaderHeight);
      requestAnimationFrame(applyHeaderHeight);
      setTimeout(applyHeaderHeight, 60);
    });

    // ---------- Loading overlay ----------
function showLoading(on){
  const el = document.getElementById("loadOverlay");
  if (!el) return;
  if (on) el.classList.add("show");
  else el.classList.remove("show");
}

// ---------- Logo click: reset all controls to defaults ----------
    function resetToDefaults(){
      // å›åˆ°é é¢æœ€ä¸Šæ–¹ï¼ˆæ‰‹æ©Ÿ/æ¡Œæ©Ÿéƒ½é©ç”¨ï¼‰
      try{ window.scrollTo({top:0,left:0,behavior:'instant'}); }catch(_){ window.scrollTo(0,0); }

      const marketSelect = document.getElementById("marketSelect");
      const filterMode = document.getElementById("filterMode");
      const sortKey = document.getElementById("sortKey");
      const searchBox = document.getElementById("searchBox");

      if (searchBox) searchBox.value = "";

      // é‡ç½®è¡¨æ ¼æ©«å‘æ²å‹•ï¼ˆæ‰‹æ©Ÿè¡¨æ ¼æ¨¡å¼å¸¸ç”¨ï¼‰
      const tw = document.querySelector('.table-wrap');
      if (tw) { try{ tw.scrollLeft = 0; }catch(_){ } }
if (marketSelect) marketSelect.value = "twse";
      if (filterMode) filterMode.value = "all";
      if (sortKey) sortKey.value = "chg_pct";

      // Sort direction default: descending
      sortAsc = false;
      const label = document.getElementById("sortDirLabel");
      if (label){
        label.textContent = "â‡£";
        label.className = "sort-anim sort-down";
        label.style.setProperty("--rot", "0deg");
      }

      // æ‰‹æ©Ÿï¼šé è¨­å›åˆ°å¡ç‰‡æ¨¡å¼ï¼ˆè‹¥å­˜åœ¨è©²åŠŸèƒ½ï¼‰
      if (typeof setMobileViewMode === "function"){
        const isPhone = window.matchMedia && window.matchMedia("(max-width: 720px)").matches;
        if (isPhone) setMobileViewMode("cards");
      }

      // âœ… æ–¹æ¡ˆ Bï¼šæ•´é é‡è¼‰ï¼ˆå¤šæ•¸æ‰‹æ©Ÿç€è¦½å™¨æœƒæŠŠç¸®æ”¾ä¸€èµ·é‡ç½®ï¼‰
      try{
        const base = window.location.pathname;
        window.location.replace(base + "?r=" + Date.now());
      }catch(_){
        window.location.href = window.location.pathname + "?r=" + Date.now();
      }
      return;
    }

// ---------- helpers ----------
    function toNum(v){
      if (v === null || v === undefined || v === "") return NaN;
      const n = Number(v);
      return Number.isFinite(n) ? n : NaN;
    }
    function eq(a,b){
      return Number.isFinite(a) && Number.isFinite(b) && Math.abs(a-b) < 0.001;
    }
    let sortAsc = false; // é è¨­é™å†ª
    let currentMarket = "twse";
    let currentFilterMode = "all";

    const numericKeys = new Set([
      "open","high","low","close","prev_close","volume","amplitude_pct","chg_pct"
    ]);

    let lastDateText = "â€”";
    let lastMarketDisplay = "";
    let lastMarketLabel = "";
    let lastTaiex = null;

    function renderTaiex(taiex){
      const closeEl = document.getElementById('taiexClose');
      const chgEl = document.getElementById('taiexChg');
      const timeEl = document.getElementById('taiexTime');
      if (!closeEl || !chgEl || !timeEl) return;
      if (!taiex || typeof taiex !== 'object' || !isFinite(Number(taiex.close))) {
        closeEl.textContent = 'â€”';
        chgEl.textContent = 'â€”';
        chgEl.className = 'taiex-chg taiex-flat';
        timeEl.textContent = '';
        return;
      }
      const close = Number(taiex.close);
      const chg = isFinite(Number(taiex.chg)) ? Number(taiex.chg) : 0;
      const chgPct = isFinite(Number(taiex.chg_pct)) ? Number(taiex.chg_pct) : null;
      closeEl.textContent = close.toLocaleString('en-US', {minimumFractionDigits:2, maximumFractionDigits:2});
      let chgText = (chg>=0?'+':'') + chg.toFixed(2);
      if (chgPct !== null) chgText += ` (${(chgPct>=0?'+':'') + chgPct.toFixed(2)}%)`;
      chgEl.textContent = chgText;
      const cls = (chg>0) ? 'taiex-up' : (chg<0 ? 'taiex-down' : 'taiex-flat');
      chgEl.className = 'taiex-chg ' + cls;
      timeEl.textContent = taiex.time_text ? String(taiex.time_text) : '';
    }

    function getFilterModeLabel() {
      return "é¡¯ç¤ºå…¨éƒ¨";
    }

    // =============================
// Encrypted results (SCN1)
// - File format: "SCN1" + salt(16) + iv(12) + ciphertext
// - Cipher: AES-256-GCM, key via PBKDF2-HMAC-SHA256
// =============================
async function _pbkdf2Key(password, salt, iterations=80000){
  const enc = new TextEncoder();
  const baseKey = await crypto.subtle.importKey("raw", enc.encode(password), "PBKDF2", false, ["deriveKey"]);
  return crypto.subtle.deriveKey(
    {name:"PBKDF2", salt, iterations, hash:"SHA-256"},
    baseKey,
    {name:"AES-GCM", length:256},
    false,
    ["decrypt"]
  );
}
async function _decryptSCN1(arrayBuffer, password){
  const u8 = new Uint8Array(arrayBuffer);
  const magic = String.fromCharCode(u8[0],u8[1],u8[2],u8[3]);
  if (magic !== "SCN1") throw new Error("ENC_BAD_MAGIC");
  const salt = u8.slice(4, 4+16);
  const iv   = u8.slice(4+16, 4+16+12);
  const ct   = u8.slice(4+16+12);
  const key = await _pbkdf2Key(password, salt, 80000);
  const ptBuf = await crypto.subtle.decrypt({name:"AES-GCM", iv}, key, ct);
  return new TextDecoder().decode(ptBuf);
}
async function _fetchAndDecryptJson(url, password){
  const r = await fetch(url + (url.includes("?") ? "&" : "?") + "r=" + Date.now(), {cache:"no-store"});
  if (!r.ok) throw new Error("HTTP_" + r.status);
  const ab = await r.arrayBuffer();
  const txt = await _decryptSCN1(ab, password);
  return JSON.parse(txt);
}
function _todayKey(){
  const d = new Date();
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,'0');
  const dd = String(d.getDate()).padStart(2,'0');
  return `${y}-${m}-${dd}`;
}

function _getSavedPw(){
  return (localStorage.getItem(_pwStoreKey) || "").trim();
}
function _setSavedPw(pw){
  localStorage.setItem(_pwStoreKey, (pw || "").trim());
}
function _clearSavedPw(){
  localStorage.removeItem(_pwStoreKey);
  // legacy keys
  localStorage.removeItem(_pwDateKey);
}

// ---------- Password Modal (tech) ----------
function _openPwModal(){
  const backdrop = document.getElementById("pwBackdrop");
  const input = document.getElementById("pwInput");
  if (!backdrop || !input) return Promise.resolve("");

  // reset ui
  input.value = "";
  input.type = "password";

  // show (ä¸å¯é»èƒŒæ™¯é—œé–‰)
  backdrop.classList.add("show");
  showLoading(false);
  const focusLater = () => setTimeout(() => { try{ input.focus(); }catch(_){ } }, 30);
  focusLater();

  return new Promise((resolve) => {
    const onOk = () => {
      const pw = (input.value || "").trim();
      if (!pw) { focusLater(); return; }
      // é»˜èªè¨˜ä½ï¼ˆåŒè£ç½®ï¼‰
      _setSavedPw(pw);
      try{ input.blur(); }catch(_){ }
      showLoading(true);
      backdrop.classList.remove("show");
      cleanup();
      resolve(pw);
    };

    const onKey = (e) => {
      if (e.key === "Enter") { e.preventDefault(); onOk(); }
      // ä¸å…è¨± ESC é—œé–‰
      if (e.key === "Escape") { e.preventDefault(); focusLater(); }
    };

    const okBtn = document.getElementById("pwOkBtn");

    function cleanup(){
      document.removeEventListener("keydown", onKey, true);
      okBtn && okBtn.removeEventListener("click", onOk);
    }

    document.addEventListener("keydown", onKey, true);
    okBtn && okBtn.addEventListener("click", onOk);
  });
}

async function _promptPassword() {
  const savedPw = _getSavedPw();
  if (savedPw) return savedPw;
  return await _openPwModal();
}


function _clearTodayPassword(){
  _clearSavedPw();
}

async function loadData(market) {
      currentMarket = market;
      const tbody = document.getElementById("resultBody");
      const summaryText = document.getElementById("summaryText");
      const countInfo = document.getElementById("countInfo");

      tbody.innerHTML = "<tr><td colspan='14'>æ­£åœ¨è¼‰å…¥çµæœ...</td></tr>";
      showLoading(true);




      // âœ… Session cache: avoid re-fetch + re-decrypt on refresh/back (esp. mobile)
      const _ssHit = _ssLoad(market);
      if (_ssHit) { _encCache[market] = _ssHit; }
// è‹¥å·²è§£å¯†éï¼ˆåŒä¸€è£ç½®ç•¶å¤©ï¼‰ï¼Œç›´æ¥ç”¨å¿«å–ï¼Œé¿å…åˆ‡æ›æ§åˆ¶é …åˆè·³å¯†ç¢¼
if (_encCache[market]) {
  const json = _encCache[market];
  allRows = json.results || [];
        // cache decrypted JSON to avoid re-prompt today
        try{ _encCache[market] = json; }catch(_){ }
  lastDateText = json.date || "â€”";
  lastMarketLabel = json.market || (market === "twse" ? "TWSE" : "OTC");
  lastMarketDisplay = market === "twse" ? "ä¸Šå¸‚" : "ä¸Šæ«ƒ";
  lastTaiex = json.taiex || null;
  renderTaiex(lastTaiex);
  summaryText.textContent = `æ—¥æœŸï¼š${lastDateText}ï½œå¸‚å ´ï¼š${lastMarketDisplay} (${lastMarketLabel})`;
  applyHeaderHeight();
  currentFilterMode = "all";
  document.getElementById("filterMode").value = "all";
  document.getElementById("sortKey").value = "chg_pct";
  sortAsc = false;
  const label = document.getElementById("sortDirLabel");
  label.textContent = "â‡£";
  label.className = "sort-anim sort-down";
  renderSorted();
  showLoading(false);
  return;
}
      countInfo.textContent = "";

      const jsonName = market === "twse" ? "results_twse.json" : "results_otc.json";
      const encName  = market === "twse" ? "results_twse.enc"  : "results_otc.enc";

      try {
        let json = null;

        // 1) å„ªå…ˆè®€å– .encï¼ˆå­˜åœ¨æ‰æœƒè©¢å•å¯†ç¢¼ï¼‰
        const encResp = await fetch(encName + "?v=" + Date.now(), { cache: "no-store" });
        if (encResp.ok) {
  // å…è¨±ä½¿ç”¨è€…å–æ¶ˆï¼›å–æ¶ˆå°±ä¸é¡¯ç¤ºè³‡æ–™
  const ab = await encResp.arrayBuffer();

  // å…ˆç”¨ã€Œå·²è¨˜ä½çš„å¯†ç¢¼ã€å˜—è©¦è§£å¯†ï¼›è‹¥å¤±æ•—è¡¨ç¤ºå¯†ç¢¼ä¸ä¸€è‡´ â†’ é‡æ–°è¼¸å…¥
  let pwd = _getSavedPw();
  if (pwd) {
    try{
      const txtTry = await _decryptSCN1(ab, pwd);
      json = JSON.parse(txtTry);
    }catch(_e){
      // stored password mismatch
      _clearSavedPw();
      pwd = "";
    }
  }

  // æ²’æœ‰å¯ç”¨å¯†ç¢¼ï¼ˆæˆ–å‰›å‰›å¤±æ•—ï¼‰â†’ å«å‡ºå½ˆçª—è®“ä½¿ç”¨è€…è¼¸å…¥
  if (!json) {
    pwd = await _openPwModal();
    if (!pwd) {
      tbody.innerHTML = "<tr><td colspan='14'>å·²å–æ¶ˆè¼¸å…¥å¯†ç¢¼ã€‚</td></tr>";
      summaryText.textContent = "å°šæœªè§£é–è³‡æ–™";
      showLoading(false);
      return;
    }
    try{
      const txt = await _decryptSCN1(ab, pwd);
      json = JSON.parse(txt);
    }catch(e2){
  // å¯†ç¢¼éŒ¯èª¤ï¼šæ¸…æ‰è¨˜ä½çš„å¯†ç¢¼ï¼Œé‡æ–°è¦æ±‚è¼¸å…¥ï¼ˆä¸é¡¯ç¤ºä»»ä½•æç¤ºï¼‰
  _clearSavedPw();
  console.error(e2);
  // é‡æ–°è·³å‡ºè¦–çª—ç›´åˆ°æˆåŠŸæˆ–ä½¿ç”¨è€…å–æ¶ˆ
  while (true){
    const pw2 = await _openPwModal();
    if (!pw2){
      tbody.innerHTML = "<tr><td colspan='14'>å°šæœªè§£é–è³‡æ–™ã€‚</td></tr>";
      summaryText.textContent = "å°šæœªè§£é–è³‡æ–™";
      showLoading(false);
      return;
    }
    try{
      const txt2 = await _decryptSCN1(ab, pw2);
      json = JSON.parse(txt2);
      break; // success
    }catch(_e3){
      _clearSavedPw();
      console.error(_e3);
      // loop again (no UI message)
    }
  }
}
  }
} else {
          // 2) fallback JSONï¼ˆçµ¦ä½ æœ¬æ©Ÿæ¸¬è©¦ç”¨ / æˆ–ä½ å°šæœªæ¨ enc çš„æƒ…æ³ï¼‰
          const resp = await fetch(jsonName + "?v=" + Date.now(), { cache: "no-store" });
          if (!resp.ok) {
            tbody.innerHTML = `<tr><td colspan='14'>æ‰¾ä¸åˆ° ${jsonName}ï¼ˆæˆ– ${encName}ï¼‰ï¼Œè«‹å…ˆç”¢ç”Ÿçµæœæª”ã€‚</td></tr>`;
            summaryText.textContent = `ç„¡æ³•è®€å– ${jsonName}`;
            showLoading(false);
            return;
          }
          json = await resp.json();
        }

        allRows = json.results || [];

        // cache decrypted/loaded JSON in sessionStorage to speed up refresh
        _ssSave(market, json);
        try{ _encCache[market] = json; }catch(_){ }

        lastDateText = json.date || "â€”";
        lastMarketLabel = json.market || (market === "twse" ? "TWSE" : "OTC");
        lastMarketDisplay = market === "twse" ? "ä¸Šå¸‚" : "ä¸Šæ«ƒ";

        // åŠ æ¬ŠæŒ‡æ•¸ï¼ˆç”±å¾Œç«¯å¯«å…¥ json.taiexï¼‰
        lastTaiex = json.taiex || null;
        renderTaiex(lastTaiex);

        summaryText.textContent =
          `æ—¥æœŸï¼š${lastDateText}ï½œå¸‚å ´ï¼š${lastMarketDisplay} (${lastMarketLabel})`;

        applyHeaderHeight();

        // é è¨­ç¯©é¸ï¼šé¡¯ç¤ºå…¨éƒ¨
        currentFilterMode = "all";
        document.getElementById("filterMode").value = "all";

        // é è¨­æ’åºï¼šæ¼²è·Œå¹…%
        document.getElementById("sortKey").value = "chg_pct";
        sortAsc = false;
        const label = document.getElementById("sortDirLabel");
        label.textContent = "â‡£";
        label.className = "sort-anim sort-down";
        renderSorted();
        showLoading(false);

      } catch (e) {
        tbody.innerHTML = "<tr><td colspan='14'>è®€å–çµæœå¤±æ•—ï¼ˆå¯èƒ½æ˜¯æª”æ¡ˆä¸å­˜åœ¨ / å¯†ç¢¼éŒ¯èª¤ / æˆ–ä»¥ file:// é–‹å•Ÿï¼‰ã€‚</td></tr>";
        summaryText.textContent = "è®€å–çµæœå¤±æ•—ï¼ˆå¯èƒ½æ˜¯æª”æ¡ˆä¸å­˜åœ¨/è§£å¯†å¤±æ•—/æˆ–ä»¥ file:// é–‹å•Ÿï¼‰";
        console.error(e);
        showLoading(false);
      }
    }

    function filterRowsByMode(rows) {
      const mode = document.getElementById("filterMode").value;
      if (mode === "limitup") {
        return (rows || []).filter(r => {
          const c = toNum(r.close);
          const u = toNum(r.limit_up ?? r.up_limit ?? r.upper_limit ?? r.limitUp ?? r.upperLimit ?? NaN);
          return u > 0 && eq(c, u);
        });
      }
      if (mode === "limitdown") {
        return (rows || []).filter(r => {
          const c = toNum(r.close);
          const d = toNum(r.limit_down ?? r.down_limit ?? r.lower_limit ?? r.limitDown ?? r.lowerLimit ?? r.downLimit ?? NaN);
          return d > 0 && eq(c, d);
        });
      }
      if (mode === "mpi") {
        return (rows || []).filter(r => {
          const v = (r.mpi ?? r.MPI ?? "").toString().trim();
          return v === "S" || v === "A" || v === "B" || v === "C";
        });
      }
      return rows;
    }

    function renderTable(rows) {
      const tbody = document.getElementById("resultBody");
      const countInfo = document.getElementById("countInfo");

      if (!rows || !rows.length) {
        tbody.innerHTML = "<tr><td colspan='14'>ç›®å‰ç¯©é¸æ¢ä»¶ä¸‹æ²’æœ‰è‚¡ç¥¨</td></tr>";
        countInfo.textContent = "ç›®å‰é¡¯ç¤ºï¼š0 æª”";
        return;
      }

      let html = "";
      rows.forEach(r => {
        const wantgoo = `https://www.wantgoo.com/stock/${r.ticker}`;
        const goodinfo = `https://goodinfo.tw/tw/StockDetail.asp?STOCK_ID=${r.ticker}`;

        const mpiVal = (r.mpi ?? r.MPI ?? "").toString().trim();
        const mpiText = mpiVal ? mpiVal : "â€”";


        const open  = toNum(r.open);
        const high  = toNum(r.high);
        const low   = toNum(r.low);
        const close = toNum(r.close);
const prevClose = Number(r.prev_close ?? r.prevClose ?? r.yclose ?? r.y_close ?? 0);

        // æˆäº¤é‡ï¼ˆæ©˜è‰²ï¼‰â€” å¾Œç«¯æ˜¯ã€Œè‚¡æ•¸ã€ï¼Œå‰ç«¯é¡¯ç¤ºã€Œå¼µæ•¸ã€(Ã·1000)
        const volNum = Number(r.volume || 0); // è‚¡
        const lots = volNum ? (volNum / 1000) : 0;
        const volText = lots ? lots.toLocaleString("en-US", { maximumFractionDigits: 0 }) : "â€”";

        // æ¼²è·Œå¹…ï¼ˆæ­£ç´…è² ç¶  + |>=7| éœ“è™¹ï¼›=0 é¡¯ç¤º zeroï¼‰
        const chgPctRaw = Number((r.chg_pct ?? r.change_pct ?? r.pct ?? r.changePct ?? 0));
        const chgPct = isFinite(chgPctRaw) ? chgPctRaw : 0;
        const isZeroChg = (chgPct === 0);
        const isHot = !isZeroChg && (Math.abs(chgPct) >= 7);
        const rowClass = isHot ? (chgPct >= 0 ? "hot-up" : "hot-down") : "";
        const chgClass = isZeroChg
          ? "amp-zero"
          : ((chgPct >= 0)
              ? (isHot ? "chg-hot-up" : "chg-up")
              : (isHot ? "chg-hot-down" : "chg-down"));
        const chgText = isZeroChg ? "zero" : ((chgPct >= 0 ? "+" : "") + chgPct.toFixed(2) + "%");

        // æŒ¯å¹…ï¼ˆæ­£ä¸”èµ°å‹¢å‘ä¸Šç´… / å‘ä¸‹ç¶ ï¼‰
        const ampRaw = Number(r.amplitude_pct ?? r.amp_pct ?? r.amplitude ?? NaN);
        const amp = Number.isFinite(ampRaw) ? ampRaw : NaN;
        const trendUp = (chgPct >= 0);
let ampClass = "";
        let ampText = "-";
        if (Number.isFinite(amp)) {
          if (amp === 0) {
            ampClass = "amp-zero";
            ampText = "zero";
          } else {
            ampClass = (amp > 0) ? (trendUp ? "amp-up" : "amp-down") : "";
            ampText = amp.toFixed(2) + "%";
          }
        }

        // âœ… æ¼²åœåƒ¹ï¼ˆé—œéµï¼‰ï¼šå¦‚æœå¾Œç«¯æ²’çµ¦ï¼Œé€™æ®µå°±ä¸è§¸ç™¼ï¼ˆä¸æœƒèª¤åˆ¤ï¼‰
        const limitUp = toNum(
          r.limit_up ?? r.up_limit ?? r.upper_limit ?? r.limitUp ?? r.upperLimit ?? NaN
        );
        const isLimitClose = limitUp > 0 && eq(close, limitUp);

        // è·Œåœåƒ¹ï¼ˆå¾Œç«¯è‹¥æä¾›ï¼‰ï¼šæ”¯æ´å¤šç¨®æ¬„ä½å‘½å
        const limitDown = toNum(
          r.limit_down ?? r.down_limit ?? r.lower_limit ?? r.limitDown ?? r.lowerLimit ?? r.downLimit ?? NaN
        );
        const isLimitDownClose = limitDown > 0 && eq(close, limitDown);


        // âœ… é€£çºŒæ¼²åœå¤©æ•¸ï¼ˆå¾Œç«¯è¨ˆç®—ï¼‰
        const streak = Number(r.limit_up_streak ?? r.limitUpStreak ?? 0) || 0;

        // âœ… ä½ çš„è¦å‰‡ï¼š
        // (3) è‚¡åƒ¹/é–‹ç›¤/æœ€é«˜/æœ€ä½ å…¨éƒ¨ == æ¼²åœåƒ¹ â†’ è¢å…‰ç´… + âš¡
        // (4) è‚¡åƒ¹/æœ€é«˜ == æ¼²åœåƒ¹ï¼Œä½†æœ€ä½ != æ¼²åœåƒ¹ â†’ ç´…è‰² + ğŸ”¥ï¼ˆæœ‰æ‰“é–‹éï¼‰
        const neonAll = (limitUp > 0)
          && eq(close, limitUp) && eq(open, limitUp) &&
             eq(high, limitUp)  && eq(low,  limitUp);

        const fireMode = (!neonAll)
          && (limitUp > 0)
          && eq(close, limitUp)
          && eq(high,  limitUp)
          && !eq(low,  limitUp);

        const showLightning = neonAll && isLimitClose;
        const showFire = fireMode && isLimitClose;

        // è·Œåœåˆ¤æ–·ï¼ˆå°ç¨±æ¼²åœï¼‰
        const neonAllDown = (limitDown > 0)
          && eq(close, limitDown) && eq(open, limitDown)
          && eq(high,  limitDown) && eq(low,  limitDown);

        const openDownMode = (!neonAllDown)
          && (limitDown > 0)
          && eq(close, limitDown)
          && eq(low,  limitDown)
          && !eq(high, limitDown);

        const showNeonGreen = neonAllDown && isLimitDownClose;
        const showGreen = openDownMode && isLimitDownClose;


        // âœ… æ¼²åœ icon åºåˆ—ï¼ˆå¾Œç«¯æä¾›ï¼šä¿ç•™æ¯ä¸€å¤©çš„ icon é¡å‹ï¼‰
        const seq = Array.isArray(r.limit_up_icon_seq) ? r.limit_up_icon_seq
                  : (Array.isArray(r.limitUpIconSeq) ? r.limitUpIconSeq : []);

        let limitIconsHtml = "";
        if (isLimitClose) {
          if (seq && seq.length > 0) {
            const maxIcons = 12;
            const showSeq = seq.slice(-maxIcons); // å–æœ€å¾Œ maxIcons å¤©ï¼ˆè¶Šé å³è¶Šæ–°ï¼‰
            const extra = seq.length - showSeq.length;

            const iconsHtml = showSeq.map(it => {
              const icon = (it && it.icon) ? String(it.icon) : "";
              const kind = (it && (it.kind || it.type || it.mode)) ? String(it.kind || it.type || it.mode) :
                           (icon === "âš¡" ? "lightning" : (icon === "ğŸ”¥" ? "fire" : ""));
              const dateTxt = (it && it.date) ? String(it.date) : "";
              const title = dateTxt ? `${dateTxt}ï½œ${kind === "lightning" ? "é–æ­»âš¡" : (kind === "fire" ? "æ‰“é–‹ğŸ”¥" : "")}` : "";
              const cls = (kind === "lightning") ? "limit-iconss--lightning" : ((kind === "fire") ? "limit-iconss--fire" : "");
              return `<span class="limit-iconss ${cls}" title="${title}">${icon}</span>`;
            }).join("");

            limitIconsHtml = `<span class="limit-icons">${iconsHtml}${extra > 0 ? `<span class="limit-iconss amp-zero" title="é‚„æœ‰ ${extra} å¤©">+${extra}</span>` : ""}</span>`;
          } else {
            // fallbackï¼šè‹¥å¾Œç«¯æ²’æä¾›åºåˆ—ï¼Œå°±ç”¨ä»Šå¤© icon ä¾ streak é‡è¤‡ï¼ˆèˆŠé‚è¼¯ï¼‰
            const iconChar = showLightning ? "âš¡" : (showFire ? "ğŸ”¥" : "");
            const iconTitle = showLightning
              ? "è‚¡åƒ¹/é–‹ç›¤/æœ€é«˜/æœ€ä½ = æ¼²åœåƒ¹ï¼ˆå…¨ç¨‹é–æ­»ï¼‰"
              : (showFire ? "è‚¡åƒ¹/æœ€é«˜ = æ¼²åœåƒ¹ï¼Œä½†æœ€ä½æ›¾æ‰“é–‹" : "");
            const iconCount = iconChar ? (streak > 0 ? streak : 1) : 0;

            if (iconCount > 0) {
              const maxIcons = 12;
              const n = Math.min(iconCount, maxIcons);
              limitIconsHtml = `<span class="limit-icons">`
                + `<span class="limit-iconss ${showLightning ? "limit-iconss--lightning" : (showFire ? "limit-iconss--fire" : "")}" title="${iconTitle}">`
                + `${iconChar.repeat(n)}${iconCount > maxIcons ? ("+" + (iconCount - maxIcons)) : ""}`
                + `</span></span>`;
            }
          }
        }

        // åƒ¹æ ¼æ¬„ä½ classï¼ˆæ¼²åœ/è·Œåœå„ªå…ˆï¼‰
        const prevCls  = "value-orange";

        // æ”¶ç›¤ï¼šæ¼²åœ/è·Œåœå„ªå…ˆï¼Œå…¶æ¬¡ä¸€èˆ¬ç´…/ç¶ /ç°
        const priceCls = showLightning
          ? "value-neonred"
          : (showFire
              ? "value-red"
              : (showNeonGreen
                  ? "value-neongreen"
                  : (showGreen
                      ? "value-green"
                      : (chgPct > 0 ? "price-up" : (chgPct < 0 ? "price-down" : "price-flat")))));

        // é–‹ç›¤/æœ€é«˜/æœ€ä½ï¼šè‹¥ç­‰æ–¼æ¼²åœ/è·Œåœåƒ¹å‰‡ä¸Šè‰²
        const openCls  = (showLightning && eq(open, limitUp)) ? "value-neonred"
          : ((showFire && eq(open, limitUp)) ? "value-red"
              : ((showNeonGreen && eq(open, limitDown)) ? "value-neongreen"
                  : ((showGreen && eq(open, limitDown)) ? "value-green" : "value-orange")));

        const highCls  = (showLightning && eq(high, limitUp)) ? "value-neonred"
          : (showFire ? (eq(high, limitUp) ? "value-red" : "value-orange")
              : ((showNeonGreen && eq(high, limitDown)) ? "value-neongreen"
                  : ((showGreen && eq(high, limitDown)) ? "value-green" : "value-orange")));

        const lowCls   = (showLightning && eq(low, limitUp)) ? "value-neonred"
          : (showFire ? (eq(low, limitUp) ? "value-red" : "value-orange")
              : ((showNeonGreen && eq(low, limitDown)) ? "value-neongreen"
                  : ((showGreen && eq(low, limitDown)) ? "value-green" : "value-orange")));

        // å°èµ°å‹¢ï¼šå‘ä¸Šç´… / å‘ä¸‹ç¶ 
        const prices = [open, high, low, close].filter(v => v > 0);
        let sparkSvg = "-";
        if (prices.length === 4) {
          const minP = Math.min(...prices);
          const maxP = Math.max(...prices);
          const range = maxP - minP || 1;
          const mapY = v => 20 - ((v - minP) / range) * 14; // 6~20

          const p1 = `${5},${mapY(open)}`;
          const p2 = `${20},${mapY(high)}`;
          const p3 = `${40},${mapY(low)}`;
          const p4 = `${55},${mapY(close)}`;

          const color = trendUp ? "#ef4444" : "#22c55e";
          sparkSvg = `
            <svg width="60" height="24">
              <polyline
                points="${p1} ${p2} ${p3} ${p4}"
                fill="none"
                stroke="${color}"
                stroke-width="2"
                style="filter: drop-shadow(0 0 4px ${color});"
              />
            </svg>
          `;
        }

        // âœ… æ–°èï¼šåªç”¨è‚¡åï¼ˆä¸è¦è‡ªå¸¶ä»£è™Ÿï¼‰
        const qName = (r.name || "").trim();
        const googleNews = `https://www.google.com/search?q=${encodeURIComponent(qName)}&tbm=nws&tbs=qdr:d2`;
        const hasNews = r.has_recent_news === true;
        const newsSample = (r.news_sample_link || "").trim();
        let newsHtml = `<a href="${googleNews}" target="_blank" class="stockLink">Googleæ–°è</a>`;
        if (hasNews && newsSample) {
          newsHtml += `&nbsp;|&nbsp;<a href="${newsSample}" target="_blank" class="stockLink">æœ€æ–°ä¸€å‰‡</a>`;
        }

        html += `
          <tr class="${rowClass}">
            <td><a class="stockLink" href="${goodinfo}" target="_blank"><span class="tag">${r.ticker}</span></a></td>

            <td>
              <a href="${wantgoo}" target="_blank" class="stockLink">
                ${r.name || "â€”"}
              </a>
            </td>

            <!-- âœ… æ¬„ä½é †åºï¼šè‚¡åƒ¹ â†’ é–‹ç›¤ â†’ æœ€é«˜ â†’ æœ€ä½ â†’ æ˜¨æ”¶ -->
            <td class="${priceCls}">
              ${close ? close.toFixed(2) : "-"}
              ${limitIconsHtml}
            </td>
            <td class="${openCls}">${open ? open.toFixed(2) : "-"}</td>
            <td class="${highCls}">${high ? high.toFixed(2) : "-"}</td>
            <td class="${lowCls}">${low ? low.toFixed(2) : "-"}</td>
            <td class="${prevCls}">${prevClose ? prevClose.toFixed(2) : "-"}</td>

            <td class="value-orange">${volText}</td>

            <td>
              <span class="mpi-badge mpi-${mpiVal || 'none'}">${mpiText}</span>
            </td>

            <td class="${chgClass}">${chgText}</td>
            <td class="${ampClass}">${ampText}</td>

            <td class="spark-cell">${sparkSvg}</td>
            <td><a class="stockLink" href="https://norway.twsthr.info/stockholders.aspx?stock=${r.ticker}" target="_blank">æŸ¥çœ‹</a></td>
            <td>${newsHtml}</td>
          </tr>
        `;
      });

      tbody.innerHTML = html;
      countInfo.textContent = `ç›®å‰é¡¯ç¤ºï¼š${rows.length} æª”`;
    }


    function renderCards(rows){
      const container = document.getElementById("cardContainer");
      const countInfo = document.getElementById("countInfo");
      if (!container) return;

      if (!rows || !rows.length){
        container.innerHTML = `<div class="card"><div style="color:#9ca3af;font-size:13px;">ç›®å‰ç¯©é¸æ¢ä»¶ä¸‹æ²’æœ‰è‚¡ç¥¨</div></div>`;
        // countInfo ç”± applySearchFilter çµ±ä¸€è™•ç†
        return;
      }

      let html = "";
      rows.forEach(r => {
        const wantgoo = `https://www.wantgoo.com/stock/${r.ticker}`;
        const goodinfo = `https://goodinfo.tw/tw/StockDetail.asp?STOCK_ID=${r.ticker}`;

        const open  = toNum(r.open);
        const high  = toNum(r.high);
        const low   = toNum(r.low);
        const close = toNum(r.close);
const prevClose = Number(r.prev_close ?? r.prevClose ?? r.yclose ?? r.y_close ?? 0);

        const volNum = Number(r.volume || 0);
        const lots = volNum ? (volNum / 1000) : 0;
        const volText = lots ? lots.toLocaleString("en-US", { maximumFractionDigits: 0 }) : "â€”";

        const mpiVal = (r.mpi ?? r.MPI ?? "").toString().trim();
        const mpiText = mpiVal ? mpiVal : "â€”";

        const chgPctRaw = Number((r.chg_pct ?? r.change_pct ?? r.pct ?? r.changePct ?? 0));
        const chgPct = isFinite(chgPctRaw) ? chgPctRaw : 0;
        const isZeroChg = (chgPct === 0);
        const isHot = !isZeroChg && (Math.abs(chgPct) >= 7);
        const chgClass = isZeroChg
          ? "amp-zero"
          : ((chgPct >= 0)
              ? (isHot ? "chg-hot-up" : "chg-up")
              : (isHot ? "chg-hot-down" : "chg-down"));
        const chgText = isZeroChg ? "zero" : ((chgPct >= 0 ? "+" : "") + chgPct.toFixed(2) + "%");

        const ampRaw = Number(r.amplitude_pct ?? r.amp_pct ?? r.amplitude ?? NaN);
        const amp = Number.isFinite(ampRaw) ? ampRaw : NaN;
        const trendUp = (chgPct >= 0);
let ampClass = "";
        let ampText = "-";
        // å°èµ°å‹¢ï¼ˆå¡ç‰‡ï¼‰ï¼šå‘ä¸Šç´… / å‘ä¸‹ç¶ ï¼ˆé¿å…åœ¨ template literal å…§å†å¡ backtickï¼‰
        const pricesCard = [open, high, low, close].filter(v => v > 0);
        let sparkSvgCard = "-";
        if (pricesCard.length === 4) {
          const minP = Math.min(...pricesCard);
          const maxP = Math.max(...pricesCard);
          const range = maxP - minP || 1;
          const mapY = v => 20 - ((v - minP) / range) * 14; // 6~20
          const p1 = `${5},${mapY(open)}`;
          const p2 = `${20},${mapY(high)}`;
          const p3 = `${40},${mapY(low)}`;
          const p4 = `${55},${mapY(close)}`;
          const color = (close >= open) ? "#ef4444" : "#22c55e";
          sparkSvgCard = `<svg width="60" height="24" style="vertical-align:middle;">
              <polyline points="${p1} ${p2} ${p3} ${p4}" fill="none" stroke="${color}" stroke-width="2"
                style="filter: drop-shadow(0 0 4px ${color});" />
            </svg>`;
        }


        if (Number.isFinite(amp)) {
          if (amp === 0) { ampClass = "amp-zero"; ampText = "zero"; }
          else { ampClass = (amp > 0) ? (trendUp ? "amp-up" : "amp-down") : ""; ampText = amp.toFixed(2) + "%"; }
        }

        const limitUp = toNum(r.limit_up ?? r.up_limit ?? r.upper_limit ?? r.limitUp ?? r.upperLimit ?? NaN);
        const isLimitClose = limitUp > 0 && eq(close, limitUp);
        const limitDown = toNum(r.limit_down ?? r.down_limit ?? r.lower_limit ?? r.limitDown ?? r.lowerLimit ?? r.downLimit ?? NaN);
        const isLimitDownClose = limitDown > 0 && eq(close, limitDown);
        const neonAll = (limitUp > 0) && eq(close, limitUp) && eq(open, limitUp) && eq(high, limitUp) && eq(low, limitUp);
        const fireMode = (!neonAll) && (limitUp > 0) && eq(close, limitUp) && eq(high, limitUp) && !eq(low, limitUp);
        const showLightning = neonAll && isLimitClose;
        const showFire = fireMode && isLimitClose;

        const neonAllDown = (limitDown > 0) && eq(close, limitDown) && eq(open, limitDown) && eq(high, limitDown) && eq(low, limitDown);
        const openDownMode = (!neonAllDown) && (limitDown > 0) && eq(close, limitDown) && eq(low, limitDown) && !eq(high, limitDown);
        const showNeonGreen = neonAllDown && isLimitDownClose;
        const showGreen = openDownMode && isLimitDownClose;


        const seq = Array.isArray(r.limit_up_icon_seq) ? r.limit_up_icon_seq
                  : (Array.isArray(r.limitUpIconSeq) ? r.limitUpIconSeq : []);
        let limitIconsHtml = "";
        if (isLimitClose) {
          if (seq && seq.length > 0) {
            const maxIcons = 12;
            const showSeq = seq.slice(-maxIcons);
            const extra = seq.length - showSeq.length;
            const iconsHtml = showSeq.map(it => {
              const icon = (it && it.icon) ? String(it.icon) : "";
              const kind = (it && (it.kind || it.type || it.mode)) ? String(it.kind || it.type || it.mode) :
                           (icon === "âš¡" ? "lightning" : (icon === "ğŸ”¥" ? "fire" : ""));
              const dateTxt = (it && it.date) ? String(it.date) : "";
              const title = dateTxt ? `${dateTxt}ï½œ${kind === "lightning" ? "é–æ­»âš¡" : (kind === "fire" ? "æ‰“é–‹ğŸ”¥" : "")}` : "";
              const cls = (kind === "lightning") ? "limit-iconss--lightning" : ((kind === "fire") ? "limit-iconss--fire" : "");
              return `<span class="limit-iconss ${cls}" title="${title}">${icon}</span>`;
            }).join("");
            limitIconsHtml = `<span class="limit-icons">${iconsHtml}${extra > 0 ? `<span class="limit-iconss amp-zero" title="é‚„æœ‰ ${extra} å¤©">+${extra}</span>` : ""}</span>`;
          } else {
            const iconChar = showLightning ? "âš¡" : (showFire ? "ğŸ”¥" : "");
            const iconTitle = showLightning
              ? "è‚¡åƒ¹/é–‹ç›¤/æœ€é«˜/æœ€ä½ = æ¼²åœåƒ¹ï¼ˆå…¨ç¨‹é–æ­»ï¼‰"
              : (showFire ? "è‚¡åƒ¹/æœ€é«˜ = æ¼²åœåƒ¹ï¼Œä½†æœ€ä½æ›¾æ‰“é–‹" : "");
            if (iconChar) {
              limitIconsHtml = `<span class="limit-icons"><span class="limit-iconss ${showLightning ? "limit-iconss--lightning" : (showFire ? "limit-iconss--fire" : "")}" title="${iconTitle}">${iconChar}</span></span>`;
            }
          }
        }

        const priceCls = showLightning
          ? "value-neonred"
          : (showFire
              ? "value-red"
              : (showNeonGreen
                  ? "value-neongreen"
                  : (showGreen
                      ? "value-green"
                      : (chgPct > 0 ? "price-up" : (chgPct < 0 ? "price-down" : "price-flat")))));

        const qName = (r.name || "").trim();
        const googleNews = `https://www.google.com/search?q=${encodeURIComponent(qName)}&tbm=nws&tbs=qdr:d2`;
        const hasNews = r.has_recent_news === true;
        const newsSample = (r.news_sample_link || "").trim();

        const norway = `https://norway.twsthr.info/stockholders.aspx?stock=${r.ticker}`;

        // æœå°‹ç”¨æ–‡å­—ï¼ˆåŒæ™‚å«ä»£è™Ÿ/åç¨±ï¼‰
        const searchText = `${String(r.ticker||"")} ${String(r.name||"")}`.toLowerCase();
        const cardClass = isLimitClose ? "card card-limitup" : (isLimitDownClose ? "card card-limitdown" : "card");

        html += `
          <div class="${cardClass}" data-search="${searchText}">
            <div class="card-top">
              <div class="card-title">
                <div class="card-name">
                  <a class="stockLink" href="${wantgoo}" target="_blank">${r.name || "â€”"}</a>
                </div>
                <div class="card-sub">
                  <a class="stockLink" href="${goodinfo}" target="_blank"><span class="tag">${r.ticker}</span></a>
                  <span class="${chgClass}">${chgText}</span>
                  <span class="mpi-badge mpi-${mpiVal || 'none'}">${mpiText}</span>
                </div>
              </div>

              <div class="card-price">
                <div class="p ${priceCls}">
                  ${close ? close.toFixed(2) : "-"}
                  ${limitIconsHtml}
                </div>
                <div class="summary">${volText} å¼µ</div>
              </div>
            </div>

            <div class="card-grid">
              <div class="kv"><span class="k">é–‹ç›¤</span><span class="v value-orange">${open ? open.toFixed(2) : "-"}</span></div>
              <div class="kv"><span class="k">æœ€é«˜</span><span class="v value-orange">${high ? high.toFixed(2) : "-"}</span></div>
              <div class="kv"><span class="k">æœ€ä½</span><span class="v value-orange">${low ? low.toFixed(2) : "-"}</span></div>
              <div class="kv"><span class="k">æ˜¨æ”¶</span><span class="v value-orange">${prevClose ? prevClose.toFixed(2) : "-"}</span></div>
              <div class="kv"><span class="k">æŒ¯å¹…</span><span class="v ${ampClass}">${ampText}</span></div>
              <div class="kv"><span class="k">èµ°å‹¢</span><span class="v">${sparkSvgCard}</span></div>
            </div>

            <div class="card-actions">
              <a href="${googleNews}" target="_blank">Googleæ–°è</a>
              ${hasNews && newsSample ? `<a href="${newsSample}" target="_blank">æœ€æ–°ä¸€å‰‡</a>` : ""}
              <a href="${norway}" target="_blank">å¤§è‚¡æ±</a>
              <a href="${goodinfo}" target="_blank">Goodinfo</a>
              <a href="${wantgoo}" target="_blank">ç©è‚¡ç¶²</a>
            </div>
          </div>
        `;
      });

      container.innerHTML = html;
    }


    function renderSorted() {
      const key = document.getElementById("sortKey").value;
      const dir = sortAsc ? 1 : -1;

      const rowsCopy = [...allRows];
      rowsCopy.sort((a, b) => {
        let va = a[key], vb = b[key];
        if (va === undefined || va === null || va === "") va = numericKeys.has(key) ? 0 : "";
        if (vb === undefined || vb === null || vb === "") vb = numericKeys.has(key) ? 0 : "";

        if (numericKeys.has(key)) return dir * ((Number(va) || 0) - (Number(vb) || 0));
        return dir * String(va).localeCompare(String(vb), "zh-Hant");
      });

      const filtered = filterRowsByMode(rowsCopy);
      renderTable(filtered);
      renderCards(filtered);
      applySearchFilter();
      updateSummaryWithFilter(filtered.length);
    }

    function applySearchFilter() {
      const keyword = document.getElementById("searchBox").value.trim().toLowerCase();

      // Table rows
      const trs = document.querySelectorAll("#resultBody tr");
      let visibleTable = 0;
      trs.forEach(tr => {
        const text = tr.innerText.toLowerCase();
        const show = text.includes(keyword);
        tr.style.display = show ? "" : "none";
        if (show) visibleTable++;
      });

      // Card view
      const cards = document.querySelectorAll("#cardContainer .card");
      let visibleCards = 0;
      cards.forEach(card => {
        const text = (card.getAttribute("data-search") || card.innerText || "").toLowerCase();
        const show = text.includes(keyword);
        card.style.display = show ? "" : "none";
        if (show) visibleCards++;
      });

      // é¡¯ç¤ºæ•¸é‡ï¼šæ¡Œæ©Ÿç”¨è¡¨æ ¼ï¼›æ‰‹æ©Ÿä¾ã€Œé¡¯ç¤ºæ¨¡å¼ã€æ±ºå®šç”¨å¡ç‰‡æˆ–è¡¨æ ¼
      const isPhone = window.matchMedia && window.matchMedia("(max-width: 720px)").matches;
      let visible = visibleTable;
      if (isPhone) {
        const useTable = document.body.classList.contains("mobile-view-table");
        visible = useTable ? visibleTable : visibleCards;
      }

      document.getElementById("countInfo").textContent = `ç›®å‰é¡¯ç¤ºï¼š${visible} æª”`;
    }

    function updateSummaryWithFilter(count) {
      const summaryText = document.getElementById("summaryText");
      summaryText.textContent =
        `æ—¥æœŸï¼š${lastDateText}ï½œå¸‚å ´ï¼š${lastMarketDisplay} (${lastMarketLabel})`;
    }

    document.getElementById("sortKey").addEventListener("change", renderSorted);

    document.getElementById("sortDirBtn").addEventListener("click", () => {
  sortAsc = !sortAsc;

  const label = document.getElementById("sortDirLabel");

  // å…ˆæ›´æ–°ç‹€æ…‹ï¼ˆæ–‡å­— + ä¸Šä¸‹æµ®æ²‰è‰²ï¼‰
  if (sortAsc){
    label.textContent = "â‡¡";
    label.className = "sort-anim sort-up";
  } else {
    label.textContent = "â‡£";
    label.className = "sort-anim sort-down";
  }

  // é»æ“Šæ™‚ï¼šå¾®æ—‹è½‰ 180Â°ï¼ˆä¸å½±éŸ¿ translateYï¼‰
  label.style.setProperty("--rot", "0deg");
  // å¼·åˆ¶ reflowï¼Œç¢ºä¿æ¯æ¬¡é»æ“Šéƒ½èƒ½è§¸ç™¼å‹•ç•«
  void label.offsetWidth;
  label.style.setProperty("--rot", "180deg");
  setTimeout(() => {
    label.style.setProperty("--rot", "0deg");
  }, 180);

  renderSorted();
});

document.getElementById("searchBox").addEventListener("input", applySearchFilter);

    document.getElementById("marketSelect").addEventListener("change", (e) => {
      loadData(e.target.value);
    });

    document.getElementById("filterMode").addEventListener("change", (e) => {
      currentFilterMode = e.target.value;
      renderSorted();
    });


    function setMobileViewMode(mode){
      // mode: "cards" | "table"
      if (mode === "table"){
        document.body.classList.add("mobile-view-table");
        document.body.classList.remove("mobile-view-cards");
        localStorage.setItem("mobileViewMode", "table");
      } else {
        document.body.classList.add("mobile-view-cards");
        document.body.classList.remove("mobile-view-table");
        localStorage.setItem("mobileViewMode", "cards");
      }
      updateSegmentActive();
      applySearchFilter();
    }

    function updateSegmentActive(){
      const btnCards = document.getElementById("viewCardsBtn");
      const btnTable = document.getElementById("viewTableBtn");
      if (!btnCards || !btnTable) return;
      const useTable = document.body.classList.contains("mobile-view-table");
      btnCards.classList.toggle("active", !useTable);
      btnTable.classList.toggle("active", useTable);
      btnCards.setAttribute("aria-selected", useTable ? "false" : "true");
      btnTable.setAttribute("aria-selected", useTable ? "true" : "false");
    }

    function initMobileViewToggle(){
      const isPhone = window.matchMedia && window.matchMedia("(max-width: 720px)").matches;

      // æ¡Œæ©Ÿ/å¹³æ¿ï¼šä¸ä½¿ç”¨æ‰‹æ©Ÿæ¨¡å¼ classï¼ˆæ¡Œæ©Ÿå°±é¡¯ç¤ºè¡¨æ ¼ï¼‰
      if (!isPhone){
        document.body.classList.remove("mobile-view-cards","mobile-view-table");
        return;
      }

      // æ‰‹æ©Ÿï¼šé è¨­å¡ç‰‡ï¼›è‹¥æœ‰è¨˜éŒ„å‰‡æ²¿ç”¨
      const saved = (localStorage.getItem("mobileViewMode") || "").toLowerCase();
      const mode = (saved === "table") ? "table" : "cards";
      setMobileViewMode(mode);

      const btnCards = document.getElementById("viewCardsBtn");
      const btnTable = document.getElementById("viewTableBtn");
      if (btnCards) btnCards.addEventListener("click", () => setMobileViewMode("cards"));
      if (btnTable) btnTable.addEventListener("click", () => setMobileViewMode("table"));
    }

    initMobileViewToggle();
    // ç¶å®š Logo é»æ“Šï¼šæ¢å¾©é è¨­
    const logo = document.getElementById("logoBtn");
    if (logo){
      logo.addEventListener("click", resetToDefaults);
    }

    // ---------- Mobile resume: show loader + refresh (avoid blank/no-effect when returning) ----------
function _refreshCurrentMarket(){
  const sel = document.getElementById("marketSelect");
  const m = sel && sel.value ? sel.value : "twse";
  return loadData(m);
}

window.addEventListener("pageshow", (e) => {
  // iOS Safari often restores from bfcache; re-show loader and refresh quietly
  if (e && e.persisted) {
    showLoading(true);
    setTimeout(() => { _refreshCurrentMarket(); }, 60);
  }
});

document.addEventListener("visibilitychange", () => {
  if (!document.hidden) {
    showLoading(true);
    setTimeout(() => { _refreshCurrentMarket(); }, 60);
  }
});


/* =======================
   Boot flow (better UX)
   - é€²ç«™ç«‹å³è·³å¯†ç¢¼
   - é»è§£é–å¾Œä¸€æ¬¡è§£å¯†ï¼šä¸Šå¸‚ + ä¸Šæ«ƒï¼ˆé¿å…åˆ‡åˆ°ä¸Šæ«ƒæ‰é–‹å§‹å¡ï¼‰
   ======================= */
function _setLoadText(txt){
  const el = document.querySelector("#loadOverlay .load-text");
  if (el) el.innerHTML = txt;
}

async function _preloadOneMarket(market, password){
  // session cache first
  const _ssHit = _ssLoad(market);
  if (_ssHit) { _encCache[market] = _ssHit; return; }
  if (_encCache[market]) return;

  const jsonName = market === "twse" ? "results_twse.json" : "results_otc.json";
  const encName  = market === "twse" ? "results_twse.enc"  : "results_otc.enc";

  // Prefer enc
  const encResp = await fetch(encName + "?v=" + Date.now(), { cache: "no-store" });
  if (encResp.ok){
    const ab = await encResp.arrayBuffer();

    // Try decrypt; if fail => reprompt until success/cancel
    while (true){
      try{
        const txt = await _decryptSCN1(ab, password);
        const json = JSON.parse(txt);
        _encCache[market] = json;
        try{ _ssSave(market, json); }catch(_){}
        return;
      }catch(e){
        _clearSavedPw();
        password = await _openPwModal();
        if (!password) throw new Error("USER_CANCEL");
      }
    }
  }

  // Fallback json (dev/local)
  const resp = await fetch(jsonName + "?v=" + Date.now(), { cache: "no-store" });
  if (!resp.ok) throw new Error("HTTP_" + resp.status);
  const json = await resp.json();
  _encCache[market] = json;
  try{ _ssSave(market, json); }catch(_){}
}

async function _preloadBothMarkets(password){
  showLoading(true);
  _setLoadText("<strong>Loading</strong>â€¦ æ­£åœ¨è§£é– / é å…ˆè§£å¯†ï¼ˆä¸Šå¸‚ + ä¸Šæ«ƒï¼‰");
  try{
    _setLoadText("<strong>Loading</strong>â€¦ é©—è­‰ä¸­");
    await _preloadOneMarket("twse", password);
    _setLoadText("<strong>Loading</strong>â€¦ é©—è­‰ä¸­");
    await _preloadOneMarket("otc", password);
  }finally{
    showLoading(false);
  }
}

// Boot ASAP (after scripts ready)
(async function boot(){
  try{
    applyHeaderHeight();

    const summaryText = document.getElementById("summaryText");
    if (summaryText) summaryText.textContent = "è«‹è¼¸å…¥å¯†ç¢¼è§£é–";

    // å…ˆæŠŠèƒŒæ™¯å…§å®¹è—èµ·ä¾†ï¼ˆé¿å…ç©ºé é¢é–ƒä¸€ä¸‹ï¼‰
    document.body.classList.add("locked");

    // ç«‹å³è·³å¯†ç¢¼ï¼ˆå¦‚æœå·²è¨˜ä½å°±ç•¥éï¼‰
    let pw = _getSavedPw();
    if (!pw){
      // next frame: avoid iOS first-paint jank
      await new Promise(r => requestAnimationFrame(() => r()));
      pw = await _openPwModal();
      if (!pw){
        if (summaryText) summaryText.textContent = "å°šæœªè§£é–è³‡æ–™";
        return;
      }
    }

    // é»ã€Œè§£é–ã€å¾Œï¼Œä¸€æ¬¡æŠŠå…©ä»½å¸‚å ´å…ˆè§£å¯†å¥½ï¼ˆå¾ŒçºŒåˆ‡æ›å°±ä¸æœƒå¡ï¼‰
    await _preloadBothMarkets(pw);

    // é¡¯ç¤ºä¸»ç•«é¢ä¸¦è¼‰å…¥é è¨­å¸‚å ´ï¼ˆæœƒèµ° cacheï¼Œè¶…å¿«ï¼‰
    document.body.classList.remove("locked");
    const sel = document.getElementById("marketSelect");
    const m = (sel && sel.value) ? sel.value : "twse";
    await loadData(m);
  }catch(e){
    console.error(e);
    document.body.classList.remove("locked");
  }
})();

  </script>

<script>
  // PWA: Service Worker registration (GitHub Pages friendly)
  (function () {
    if (!("serviceWorker" in navigator)) return;
    window.addEventListener("load", () => {
      navigator.serviceWorker.register("./sw.js", { scope: "./" }).catch(() => {});
    });
  })();
</script>

</div>

<!-- Password Modal -->
<div id="pwBackdrop" class="pw-backdrop" role="dialog" aria-modal="true" aria-labelledby="pwTitle">
  <div class="pw-modal">
    <div class="pw-head">
      <div class="pw-title" id="pwTitle">
        <img src="data:image/png;base64,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" alt="SCAN" style="width:36px;height:36px;border-radius:8px;box-shadow:0 0 14px rgba(59,130,246,.22);" />
        
      </div>
</div>

    <div class="pw-body" style="padding-top: 10px;">
      <input id="pwInput" class="pw-input" type="password" autocomplete="current-password" placeholder="è¼¸å…¥å¯†ç¢¼â€¦" />
      <div class="pw-error" id="pwError" style="display:none;"></div>

      <div class="pw-actions" style="justify-content:center;">
        <button class="pw-btn primary" id="pwOkBtn" type="button" >è§£é–</button>
      </div>
    </div>
  </div>
</div>
</div>
</div>

<!-- Tech Loading Overlay -->
<div id="loadOverlay" class="load-overlay" aria-hidden="true">
  <div class="load-card">
    <div class="load-spinner" aria-hidden="true"></div>
    <div class="load-text"><strong>Loading</strong>â€¦ æ­£åœ¨è§£é– / è¼‰å…¥è³‡æ–™</div>
  </div>
</div>

</body>
</html>